<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-03-20">

<title>IS415-GAA - Application of Spatial and Spatio-temporal Analysis Methods to Discover the Distribution of Dengue Fever in Tainan City, Taiwan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03-1.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3-1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03-2.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3-2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05-1.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5-1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05-2.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5-2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03-KDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3 KDE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3 NKDE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-geospatial-analytics-project" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Geospatial Analytics Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-geospatial-analytics-project">    
        <li>
    <a class="dropdown-item" href="../../Project/Project_Proposal.html" rel="" target="">
 <span class="dropdown-text">Project Proposal</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1 Introduction</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">2 The Data</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">3 Getting Started</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">4 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">4.1 Importing geospatial data</a></li>
  <li><a href="#aspatial-data-wrangling" id="toc-aspatial-data-wrangling" class="nav-link" data-scroll-target="#aspatial-data-wrangling">4.2 Aspatial Data Wrangling</a></li>
  <li><a href="#cleaning-and-updating-attribute-fields-of-the-geospatial-data" id="toc-cleaning-and-updating-attribute-fields-of-the-geospatial-data" class="nav-link" data-scroll-target="#cleaning-and-updating-attribute-fields-of-the-geospatial-data">4.3 Cleaning and updating attribute fields of the geospatial data</a></li>
  <li><a href="#getting-centroid-points-from-hexagon" id="toc-getting-centroid-points-from-hexagon" class="nav-link" data-scroll-target="#getting-centroid-points-from-hexagon">4.4 Getting centroid points from hexagon</a></li>
  <li><a href="#get-distance-matrix" id="toc-get-distance-matrix" class="nav-link" data-scroll-target="#get-distance-matrix">4.5 Get Distance Matrix</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">5 Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#modelling-and-visualizing-accessibility-using-hansen-method" id="toc-modelling-and-visualizing-accessibility-using-hansen-method" class="nav-link" data-scroll-target="#modelling-and-visualizing-accessibility-using-hansen-method">7 Modelling and Visualizing Accessibility using Hansen Method</a></li>
  <li><a href="#computing-hansens-accessibility" id="toc-computing-hansens-accessibility" class="nav-link" data-scroll-target="#computing-hansens-accessibility">7.1 Computing Hansen’s Accessibility</a>
  <ul class="collapse">
  <li><a href="#visualizing-hansens-accessibility" id="toc-visualizing-hansens-accessibility" class="nav-link" data-scroll-target="#visualizing-hansens-accessibility">7.2 Visualizing Hansen’s Accessibility</a>
  <ul class="collapse">
  <li><a href="#extracting-map-extend" id="toc-extracting-map-extend" class="nav-link" data-scroll-target="#extracting-map-extend">7.2.1 Extracting Map Extend</a></li>
  </ul></li>
  <li><a href="#statistical-graphic-visualization" id="toc-statistical-graphic-visualization" class="nav-link" data-scroll-target="#statistical-graphic-visualization">7.3 Statistical Graphic Visualization</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Application of Spatial and Spatio-temporal Analysis Methods to Discover the Distribution of Dengue Fever in Tainan City, Taiwan</h1>
<p class="subtitle lead">Take-home_Ex03</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 20, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 23, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>1 Introduction</h1>
</section>
<section id="the-data" class="level1">
<h1>2 The Data</h1>
</section>
<section id="getting-started" class="level1">
<h1>3 Getting Started</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, SpatialAcc, sf, ggstatsplot, reshape2, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-wrangling" class="level1">
<h1>4 Data Wrangling</h1>
<section id="importing-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-data">4.1 Importing geospatial data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"MP14_SUBZONE_NO_SEA_PL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MP14_SUBZONE_NO_SEA_PL' from data source 
  `C:\russelltjh\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hexagons <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer=</span><span class="st">"hexagons"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `hexagons' from data source 
  `C:\russelltjh\IS415-GAA\Take-home_Ex\Take-home_Ex03\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 3125 features and 6 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 21506.33 xmax: 50010.26 ymax: 50256.33
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</section>
<section id="aspatial-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="aspatial-data-wrangling">4.2 Aspatial Data Wrangling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>schools <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/school_coordinates.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>schools_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(schools,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>, <span class="st">"Latitude"</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>schools_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 410 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 11750.82 ymin: 28603.93 xmax: 42410.51 ymax: 48769.53
Projected CRS: SVY21 / Singapore TM
# A tibble: 410 × 6
    ...1 SCHOOL                    AREA  TYPE  ADDRESS            geometry
 * &lt;dbl&gt; &lt;chr&gt;                     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;           &lt;POINT [m]&gt;
 1     0 Admiralty Primary School  Wood… Prim… 11 WOO… (24296.62 47144.77)
 2     1 Ahmad Ibrahim Primary Sc… Yish… Prim… 10 YIS… (27958.14 46096.26)
 3     2 Ai Tong School            Bish… Prim… 100 BR… (27966.81 38071.92)
 4     3 Alexandra Primary School  Buki… Prim… 2A PRI… (27010.19 30414.72)
 5     4 Anchor Green Primary Sch… Seng… Prim… 31 ANC… (33992.45 41365.63)
 6     5 Anderson Primary School   Ang … Prim… 19 ANG… (28898.48 40690.43)
 7     6 Ang Mo Kio Primary School Ang … Prim… 20 ANG… (28702.49 39038.16)
 8     7 Anglo-Chinese School (Ju… Cent… Prim… 16 WIN… (28916.31 32403.75)
 9     8 Anglo-Chinese School (Pr… Buki… Prim… 50 BAR… (28254.98 33404.23)
10     9 Angsana Primary School    Tamp… Prim… 3 TAMP… (41160.87 36732.32)
# ℹ 400 more rows</code></pre>
</div>
</div>
</section>
<section id="cleaning-and-updating-attribute-fields-of-the-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-and-updating-attribute-fields-of-the-geospatial-data">4.3 Cleaning and updating attribute fields of the geospatial data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>schools_sf <span class="ot">&lt;-</span> schools_sf <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(...<span class="dv">1</span>, SCHOOL) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">capacity =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>hexagons <span class="ot">&lt;-</span> hexagons <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fid) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">demand =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="getting-centroid-points-from-hexagon" class="level2">
<h2 class="anchored" data-anchor-id="getting-centroid-points-from-hexagon">4.4 Getting centroid points from hexagon</h2>
<p>We need to get the centroid of the hexagon so that we can use it to calculate the euclidean distance from each school later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>hexagon_points <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(hexagons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>hexagon_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3125 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 2956.213 ymin: 21756.33 xmax: 49721.58 ymax: 50006.33
Projected CRS: SVY21 / Singapore TM
First 10 features:
   fid                  geometry demand
1    1 POINT (2956.213 27506.33)    100
2    2 POINT (2956.213 25006.33)    100
3    3 POINT (2956.213 24506.33)    100
4    4 POINT (2956.213 24006.33)    100
5    5 POINT (2956.213 23506.33)    100
6    6 POINT (2956.213 23006.33)    100
7    7 POINT (3389.226 28756.33)    100
8    8 POINT (3389.226 28256.33)    100
9    9 POINT (3389.226 27756.33)    100
10  10 POINT (3389.226 27256.33)    100</code></pre>
</div>
</div>
</section>
<section id="get-distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="get-distance-matrix">4.5 Get Distance Matrix</h2>
<p>Based on the hexagon centroids and location of the schools, we will generate a distance matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(hexagon_points, schools_sf, <span class="at">by_element =</span> <span class="cn">FALSE</span>) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distance_matrix, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Units: [m]
         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
[1,] 29001.40 31155.76 27150.71 24229.16 33990.12 29100.20 28210.88 26418.02
[2,] 30749.36 32709.04 28217.71 24654.50 35083.82 30314.88 29321.71 26993.49
[3,] 31111.28 33033.64 28452.68 24768.99 35319.74 30576.56 29564.24 27134.78
         [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
[1,] 25977.16 39302.85 22616.77 37244.72 29295.31 22329.67 14473.01 21577.25
[2,] 26656.19 39963.66 24156.05 37758.66 29930.88 22605.19 16085.33 23062.19
[3,] 26817.91 40113.22 24482.94 37880.41 30081.32 22692.96 16434.47 23379.95
        [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]
[1,] 19369.41 18483.92 30945.75 31238.86 25809.05 40587.62 28053.55 30757.54
[2,] 20527.53 19813.99 32662.59 31877.58 26040.91 41388.42 29028.52 31484.68
[3,] 20787.50 20106.76 33017.96 32027.22 26115.77 41564.78 29245.26 31651.81
        [,25]    [,26]    [,27]    [,28]    [,29]    [,30]    [,31]    [,32]
[1,] 39153.89 34011.07 24494.34 30237.68 34348.78 20970.44 27050.07 27860.42
[2,] 39759.96 34437.22 24733.50 31171.33 35298.01 22409.06 27845.96 29024.29
[3,] 39898.87 34543.54 24811.30 31378.63 35505.93 22718.88 28029.19 29277.14
        [,33]    [,34]    [,35]    [,36]    [,37]    [,38]    [,39]    [,40]
[1,] 32053.42 39342.58 19397.71 18100.28 35255.81 19134.81 14577.77 35691.88
[2,] 33608.88 40018.22 21091.37 19013.98 36342.43 20883.04 16318.44 36319.41
[3,] 33933.53 40170.66 21449.03 19230.55 36576.39 21250.73 16689.74 36464.20
        [,41]    [,42]    [,43]    [,44]    [,45]    [,46]    [,47]    [,48]
[1,] 18755.84 20761.96 40505.36 36497.07 39393.14 31282.12 28672.81 20102.33
[2,] 20250.54 22561.12 41175.19 37590.84 40231.82 33004.82 30453.44 20736.10
[3,] 20572.92 22936.72 41326.01 37825.64 40416.03 33361.17 30821.56 20896.47
        [,49]    [,50]    [,51]    [,52]    [,53]    [,54]    [,55]    [,56]
[1,] 27488.51 36699.52 33621.70 32699.49 28747.57 12890.59 26321.37 16276.48
[2,] 28072.04 37268.19 34781.89 33834.38 29568.55 14560.60 28118.06 17627.86
[3,] 28213.89 37400.94 35030.73 34078.84 29755.24 14922.47 28490.13 17927.77
        [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]    [,64]
[1,] 23177.80 31212.81 39277.08 36827.02 22219.80 29185.95 33242.66 20403.52
[2,] 23554.82 31773.39 39998.98 37883.45 23807.32 30899.02 33719.99 21239.28
[3,] 23661.22 31907.84 40160.48 38110.90 24143.38 31254.37 33836.82 21437.53
        [,65]    [,66]    [,67]    [,68]    [,69]    [,70]    [,71]    [,72]
[1,] 33746.59 28449.38 37071.30 32774.25 31783.51 27208.54 30572.13 29613.44
[2,] 34661.57 29102.93 38143.20 33801.15 33256.20 28934.24 32106.60 30699.74
[3,] 34863.20 29257.53 38373.53 34024.85 33565.33 29292.79 32427.91 30936.68
        [,73]    [,74]    [,75]    [,76]    [,77]    [,78]    [,79]    [,80]
[1,] 37963.11 12988.44 12988.44 18662.20 27756.85 31580.18 21013.23 29000.12
[2,] 38642.57 14695.02 14695.02 19969.37 28576.94 32077.57 22778.65 29898.18
[3,] 38796.37 15062.95 15062.95 20257.72 28764.24 32199.43 23147.98 30099.50
        [,81]    [,82]    [,83]    [,84]    [,85]    [,86]    [,87]    [,88]
[1,] 14655.97 18996.93 33355.26 31165.60 26212.19 27101.66 28902.80 36362.76
[2,] 16171.08 20407.25 33969.07 31933.74 28047.43 27971.43 30052.98 37418.52
[3,] 16502.88 20714.01 34112.49 32108.53 28426.65 28168.79 30302.54 37646.05
        [,89]    [,90]    [,91]    [,92]    [,93]    [,94]    [,95]    [,96]
[1,] 38346.02 32176.67 33545.67 34481.18 18030.08 23040.29 30624.85 21687.43
[2,] 39214.27 32988.99 34519.57 35574.10 19007.45 23831.99 32058.81 22264.99
[3,] 39404.66 33171.68 34732.67 35809.63 19235.99 24018.44 32361.16 22412.20
        [,97]    [,98]    [,99]   [,100]   [,101]   [,102]   [,103]   [,104]
[1,] 34698.41 35486.50 32187.57 34563.23 31106.92 31166.67 37050.19 37038.42
[2,] 35108.66 36510.40 33647.09 35580.76 32559.25 32917.13 38257.23 38146.84
[3,] 35211.45 36732.18 33953.56 35801.75 32864.83 33278.72 38513.58 38384.23
       [,105]   [,106]   [,107]   [,108]   [,109]   [,110]   [,111]   [,112]
[1,] 35629.91 34128.98 38902.08 41202.54 32176.67 28616.36 20347.47 18609.50
[2,] 36140.20 35166.53 39771.07 41991.34 32988.99 29407.70 21462.60 19522.06
[3,] 36262.09 35391.58 39961.37 42165.12 33171.68 29588.79 21713.31 19737.53
       [,113]   [,114]   [,115]   [,116]   [,117]   [,118]   [,119]   [,120]
[1,] 29892.05 12049.55 37801.03 17459.63 36175.25 35696.70 36490.70 36490.70
[2,] 31369.32 13869.09 38553.55 18911.00 37362.07 36826.08 37620.31 37620.31
[3,] 31680.18 14257.76 38721.67 19227.15 37614.88 37068.07 37862.00 37862.00
       [,121]   [,122]   [,123]   [,124]   [,125]   [,126]   [,127]   [,128]
[1,] 17349.16 28010.86 22431.83 24052.71 23173.08 37061.22 25526.54 29480.77
[2,] 18273.24 29811.39 22941.96 24295.49 24058.91 37649.66 25961.38 31240.58
[3,] 18493.10 30183.46 23075.16 24374.55 24263.13 37786.10 26076.26 31604.51
       [,129]   [,130]   [,131]   [,132]   [,133]   [,134]   [,135]   [,136]
[1,] 35897.94 31989.02 15230.40 30934.82 35237.50 32897.20 15565.51 27089.84
[2,] 36957.95 33002.72 16834.19 32599.90 36286.99 34046.16 17152.71 28855.65
[3,] 37186.50 33224.33 17180.66 32945.58 36513.82 34293.21 17495.76 29221.68
       [,137]   [,138]   [,139]   [,140]   [,141]   [,142]   [,143]   [,144]
[1,] 25190.12 20054.22 34465.91 29509.78 37846.69 37846.69 29798.72 37753.58
[2,] 25915.80 21746.42 35578.41 30228.65 38433.77 38433.77 30674.06 38447.64
[3,] 26087.28 22103.26 35817.70 30395.07 38569.56 38569.56 30870.46 38604.39
       [,145]   [,146]   [,147]   [,148]   [,149]   [,150]   [,151]   [,152]
[1,] 27051.42 31119.86 34895.48 39334.76 38519.23 32764.04 26987.09 29206.08
[2,] 27698.58 31741.37 35407.16 40078.05 39202.51 33193.70 27399.86 30246.32
[3,] 27853.15 31887.74 35529.72 40243.70 39356.80 33301.49 27508.95 30474.73
       [,153]   [,154]   [,155]   [,156]   [,157]   [,158]   [,159]   [,160]
[1,] 20867.01 34463.51 37987.81 29275.59 21678.76 35960.49 37572.29 31533.25
[2,] 22525.42 35078.22 38450.59 30262.74 23503.58 37118.82 38625.12 33225.31
[3,] 22875.47 35221.17 38561.93 30480.95 23883.22 37366.25 38851.57 33575.83
       [,161]   [,162]   [,163]   [,164]   [,165]   [,166]   [,167]   [,168]
[1,] 13435.97 22317.87 21413.56 13708.55 40784.39 27457.01 27852.69 28216.15
[2,] 15196.14 23939.94 23031.43 15478.90 41536.00 29203.71 29611.67 29939.03
[3,] 15572.48 24282.24 23373.66 15856.57 41702.69 29566.04 29976.10 30296.61
       [,169]   [,170]   [,171]   [,172]   [,173]   [,174]   [,175]   [,176]
[1,] 33041.00 12315.34 32765.33 31607.97 30409.30 21549.97 33295.91 31273.43
[2,] 33901.44 14172.65 33743.48 33142.72 31260.26 23312.76 34311.63 32823.11
[3,] 34092.92 14567.20 33957.83 33463.64 31451.54 23681.24 34532.91 33146.98
       [,177]   [,178]   [,179]   [,180]   [,181]   [,182]   [,183]   [,184]
[1,] 36837.61 17101.07 39256.96 24316.59 21943.15 30943.98 29438.42 31063.26
[2,] 37434.34 18484.98 39938.10 24660.71 23474.79 31881.00 31190.75 32645.57
[3,] 37572.52 18789.47 40091.65 24759.27 23800.81 32088.50 31553.31 32975.66
       [,185]   [,186]   [,187]   [,188]   [,189]   [,190]   [,191]   [,192]
[1,] 29648.71 28379.28 37836.39 25907.92 19621.98 21008.67 21018.83 31654.56
[2,] 30752.71 29465.16 38398.13 26596.19 20313.87 22466.73 22492.08 32398.83
[3,] 30993.00 29702.83 38528.96 26759.76 20486.08 22780.08 22808.21 32568.68
       [,193]   [,194]   [,195]   [,196]   [,197]   [,198]   [,199]   [,200]
[1,] 28449.64 37165.99 38714.12 37904.73 28882.52 13502.83 32161.31 31355.05
[2,] 29292.83 37762.14 39220.72 38414.96 29553.17 15216.15 33148.65 31821.70
[3,] 29484.02 37900.04 39340.33 38535.66 29710.74 15584.36 33365.10 31937.70
       [,201]   [,202]   [,203]   [,204]   [,205]   [,206]   [,207]   [,208]
[1,] 17403.99 22945.36 19430.44 18336.97 30952.31 28053.55 30524.85 39263.74
[2,] 18849.20 23327.29 21180.08 19675.18 32685.23 29028.52 31241.22 39863.11
[3,] 19164.32 23434.95 21547.77 19969.64 33043.60 29245.26 31406.42 40000.66
       [,209]   [,210]   [,211]   [,212]   [,213]   [,214]   [,215]   [,216]
[1,] 34676.50 27193.56 35611.45 27860.42 23860.47 27270.85 20641.80 31845.48
[2,] 35094.24 27982.48 36667.24 29024.29 24109.70 28969.95 22308.33 32288.28
[3,] 35198.50 28164.25 36895.10 29277.14 24190.26 29323.54 22660.03 32399.27
       [,217]   [,218]   [,219]   [,220]   [,221]   [,222]   [,223]   [,224]
[1,] 30672.42 17997.49 16417.56 35538.97 23497.39 40888.11 36359.54 29386.81
[2,] 32129.38 18923.11 17485.35 36629.99 23958.64 41685.66 36986.71 30424.59
[3,] 32436.05 19142.08 17733.52 36864.66 24081.00 41861.26 37131.07 30652.40
       [,225]   [,226]   [,227]   [,228]   [,229]   [,230]   [,231]   [,232]
[1,] 18689.47 30809.45 40138.34 40489.13 36029.80 28434.64 19980.37 26282.47
[2,] 20249.23 31221.54 40868.13 41183.00 37139.54 30204.94 20632.53 28082.29
[3,] 20583.45 31327.26 41030.81 41338.53 37377.60 30571.24 20796.60 28454.95
       [,233]   [,234]   [,235]   [,236]   [,237]   [,238]   [,239]   [,240]
[1,] 15978.88 24123.96 31084.49 36783.09 21208.15 28318.04 40430.05 18798.43
[2,] 17518.61 24525.62 31647.84 37844.24 22741.30 29189.84 41246.55 20202.00
[3,] 17852.65 24635.63 31782.92 38072.62 23068.22 29386.62 41426.02 20507.78
       [,241]   [,242]   [,243]   [,244]   [,245]   [,246]   [,247]   [,248]
[1,] 34158.54 32963.11 15902.78 22947.78 37536.36 14742.63 13011.69 16467.52
[2,] 35099.07 33986.40 17533.46 23790.27 38264.92 16109.84 14641.76 18031.07
[3,] 35305.42 34209.31 17883.71 23986.49 38428.49 16415.34 14996.56 18368.65
       [,249]   [,250]   [,251]   [,252]   [,253]   [,254]   [,255]   [,256]
[1,] 11989.52 17881.94 20245.64 29024.10 40394.16 33378.06 31165.60 26617.88
[2,] 13810.96 18601.77 22028.54 29928.58 41159.27 33983.33 31933.74 28454.21
[3,] 14200.05 18782.39 22401.58 30131.12 41328.74 34125.08 32108.53 28833.45
       [,257]   [,258]   [,259]   [,260]   [,261]   [,262]   [,263]   [,264]
[1,] 27729.89 39563.55 32240.84 33474.58 34208.85 18461.59 22788.67 22956.93
[2,] 28849.19 40348.96 33064.09 34453.19 35283.45 19258.49 23702.64 23861.10
[3,] 29093.67 40522.72 33248.85 34667.23 35515.58 19452.54 23912.62 24069.03
       [,265]   [,266]   [,267]   [,268]   [,269]   [,270]   [,271]   [,272]
[1,] 30098.01 19007.12 40021.39 34826.77 31489.26 31971.07 28182.69 18505.30
[2,] 31582.83 19805.52 40711.35 35823.78 32923.41 33508.41 28816.79 19278.45
[3,] 31895.01 19998.91 40866.30 36040.68 33225.39 33829.67 28967.84 19467.95
       [,273]   [,274]   [,275]   [,276]   [,277]   [,278]   [,279]   [,280]
[1,] 30478.15 25578.20 40888.11 40888.11 32240.84 33108.27 30944.22 27134.79
[2,] 31910.16 25930.11 41685.66 41685.66 33064.09 34230.20 31875.27 28261.88
[3,] 32212.21 26028.75 41861.26 41861.26 33248.85 34471.96 32081.62 28508.27
       [,281]   [,282]   [,283]   [,284]   [,285]   [,286]   [,287]   [,288]
[1,] 29163.36 36757.94 23020.32 21929.38 27492.90 27922.49 21295.26 14215.76
[2,] 30355.01 37857.03 23493.33 22507.86 28368.29 28823.33 23035.69 15875.83
[3,] 30612.28 38092.74 23618.56 22654.91 28566.41 29025.99 23400.31 16233.70
       [,289]   [,290]   [,291]   [,292]   [,293]   [,294]   [,295]   [,296]
[1,] 27936.24 19188.83 27022.20 30596.01 34969.38 31250.49 31250.49 25230.80
[2,] 29732.61 20023.54 27485.11 32280.64 36004.42 32256.85 32256.85 25953.50
[3,] 30103.93 20223.46 27603.94 32630.12 36228.59 32477.48 32477.48 26124.36
       [,297]   [,298]   [,299]   [,300]   [,301]   [,302]   [,303]   [,304]
[1,] 26924.07 28924.81 37041.84 29612.50 37926.17 31135.50 37828.05 25350.15
[2,] 28642.25 30626.65 37750.36 30322.48 38511.60 31948.47 38523.30 26101.54
[3,] 28999.53 30980.02 37910.26 30487.10 38647.03 32131.94 38680.25 26277.79
       [,305]   [,306]   [,307]   [,308]   [,309]   [,310]   [,311]   [,312]
[1,] 23253.66 34752.34 19277.79 38533.32 32353.90 32517.10 36899.70 38175.18
[2,] 24029.38 35180.49 20808.60 39212.70 32816.13 32981.43 37381.76 38622.91
[3,] 24212.53 35286.76 21136.95 39366.23 32930.58 33096.18 37497.44 38731.20
       [,313]   [,314]   [,315]   [,316]   [,317]   [,318]   [,319]   [,320]
[1,] 21395.18 35905.21 21677.65 14299.00 27906.98 27616.00 28554.61 28554.61
[2,] 23208.47 36326.10 23325.07 16116.95 28893.24 29311.61 30272.27 30272.27
[3,] 23586.21 36430.29 23672.49 16501.97 29112.25 29664.39 30628.73 30628.73
       [,321]   [,322]   [,323]   [,324]   [,325]   [,326]   [,327]   [,328]
[1,] 32808.69 28866.57 30451.93 31563.74 15149.82 15640.48 35684.95 32985.10
[2,] 33795.11 30032.86 31996.01 33090.94 16683.09 17213.28 36852.70 33840.64
[3,] 34011.02 30285.49 32319.18 33410.45 17017.26 17553.68 37102.06 34031.21
       [,329]   [,330]   [,331]   [,332]   [,333]   [,334]   [,335]   [,336]
[1,] 22184.57 30489.86 29276.58 20149.50 19621.98 26078.37 30809.45 28065.69
[2,] 23803.23 31336.52 30435.95 20815.08 20313.87 26818.67 31221.54 29113.91
[3,] 24145.01 31526.92 30687.02 20981.43 20486.08 26992.09 31327.26 29344.63
       [,337]   [,338]   [,339]   [,340]   [,341]   [,342]   [,343]   [,344]
[1,] 22947.78 20939.86 17579.60 30243.02 22956.93 18505.30 27922.49 14215.76
[2,] 23790.27 22598.88 19038.02 31113.08 23861.10 19278.45 28823.33 15875.83
[3,] 23986.49 22948.98 19355.29 31308.15 24069.03 19467.95 29025.99 16233.70
       [,345]   [,346]   [,347]   [,348]   [,349]   [,350]   [,351]   [,352]
[1,] 27022.20 26924.07 29390.25 25350.15 38596.08 36899.70 34993.40 30315.41
[2,] 27485.11 28642.25 30127.24 26101.54 39464.47 37381.76 35409.42 31832.54
[3,] 27603.94 28999.53 30297.25 26277.79 39654.78 37497.44 35513.16 32150.71
       [,353]   [,354]   [,355]   [,356]   [,357]   [,358]   [,359]   [,360]
[1,] 29779.40 20242.84 27836.33 30128.94 36833.40 30302.80 39345.99 20106.02
[2,] 30939.36 21303.85 29653.92 30780.57 37533.83 31415.08 39908.69 21708.29
[3,] 31190.23 21544.62 30029.21 30933.50 37692.25 31656.54 40039.01 22048.79
       [,361]   [,362]   [,363]   [,364]   [,365]   [,366]   [,367]   [,368]
[1,] 24181.98 34023.57 28190.57 38364.73 29238.01 30739.94 18750.47 27455.26
[2,] 24606.28 35117.32 29296.34 39145.94 29881.58 31465.10 20248.62 28035.25
[3,] 24720.62 35353.23 29537.93 39319.40 30033.62 31631.86 20571.62 28176.44
       [,369]   [,370]   [,371]   [,372]   [,373]   [,374]   [,375]   [,376]
[1,] 36729.46 33604.77 32633.60 28810.59 12928.44 39285.62 36876.30 37059.55
[2,] 37296.89 34765.92 33765.48 29628.15 14604.94 40006.25 37927.86 38132.36
[3,] 37429.39 35014.96 34009.39 29814.13 14967.83 40167.50 38154.35 38362.87
       [,377]   [,378]   [,379]   [,380]   [,381]   [,382]   [,383]   [,384]
[1,] 31790.29 29548.13 37935.50 13040.23 20979.48 28923.81 38346.42 30629.04
[2,] 33265.41 30630.89 38616.75 14749.61 22749.09 30078.15 39214.96 32059.32
[3,] 33574.99 30867.19 38770.91 15117.93 23119.21 30328.49 39405.41 32360.97
       [,385]   [,386]   [,387]   [,388]   [,389]   [,390]   [,391]   [,392]
[1,] 32194.54 34583.13 31251.26 37136.89 37097.36 18630.65 17405.83 36524.44
[2,] 33653.17 35597.99 33003.14 38343.26 38208.49 19540.29 18864.61 37657.75
[3,] 33959.47 35818.45 33364.96 38599.44 38446.38 19755.18 19182.16 37900.14
       [,393]   [,394]   [,395]   [,396]   [,397]   [,398]   [,399]   [,400]
[1,] 36218.93 35718.09 36524.44 29550.52 30992.04 32859.28 15518.04 34442.72
[2,] 37407.27 36850.71 37657.75 31313.73 32659.89 34007.03 17096.99 35560.72
[3,] 37660.35 37093.30 37900.14 31678.28 33006.07 34253.87 17438.65 35801.09
       [,401]   [,402]   [,403]   [,404]   [,405]   [,406]   [,407]   [,408]
[1,] 38458.66 37997.87 35958.15 37583.40 31534.10 22317.76 21425.43 13741.65
[2,] 39144.16 38456.91 37121.06 38642.36 33224.16 23936.81 23046.10 15517.60
[3,] 39298.91 38567.51 37369.38 38869.99 33574.31 24278.56 23388.84 15896.18
       [,409]   [,410]
[1,] 31309.08 21970.93
[2,] 32862.03 23499.35
[3,] 33186.51 23824.76</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>distance_matrix_km <span class="ot">&lt;-</span> distance_matrix <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distance_matrix_km, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Units: [m]
         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
[1,] 29.00140 31.15576 27.15071 24.22916 33.99012 29.10020 28.21088 26.41802
[2,] 30.74936 32.70904 28.21771 24.65450 35.08382 30.31488 29.32171 26.99349
[3,] 31.11128 33.03364 28.45268 24.76899 35.31974 30.57656 29.56424 27.13478
         [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
[1,] 25.97716 39.30285 22.61677 37.24472 29.29531 22.32967 14.47301 21.57725
[2,] 26.65619 39.96366 24.15605 37.75866 29.93088 22.60519 16.08533 23.06219
[3,] 26.81791 40.11322 24.48294 37.88041 30.08132 22.69296 16.43447 23.37995
        [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]
[1,] 19.36941 18.48392 30.94575 31.23886 25.80905 40.58762 28.05355 30.75754
[2,] 20.52753 19.81399 32.66259 31.87758 26.04091 41.38842 29.02852 31.48468
[3,] 20.78750 20.10676 33.01796 32.02722 26.11577 41.56478 29.24526 31.65181
        [,25]    [,26]    [,27]    [,28]    [,29]    [,30]    [,31]    [,32]
[1,] 39.15389 34.01107 24.49434 30.23768 34.34878 20.97044 27.05007 27.86042
[2,] 39.75996 34.43722 24.73350 31.17133 35.29801 22.40906 27.84596 29.02429
[3,] 39.89887 34.54354 24.81130 31.37863 35.50593 22.71888 28.02919 29.27714
        [,33]    [,34]    [,35]    [,36]    [,37]    [,38]    [,39]    [,40]
[1,] 32.05342 39.34258 19.39771 18.10028 35.25581 19.13481 14.57777 35.69188
[2,] 33.60888 40.01822 21.09137 19.01398 36.34243 20.88304 16.31844 36.31941
[3,] 33.93353 40.17066 21.44903 19.23055 36.57639 21.25073 16.68974 36.46420
        [,41]    [,42]    [,43]    [,44]    [,45]    [,46]    [,47]    [,48]
[1,] 18.75584 20.76196 40.50536 36.49707 39.39314 31.28212 28.67281 20.10233
[2,] 20.25054 22.56112 41.17519 37.59084 40.23182 33.00482 30.45344 20.73610
[3,] 20.57292 22.93672 41.32601 37.82564 40.41603 33.36117 30.82156 20.89647
        [,49]    [,50]    [,51]    [,52]    [,53]    [,54]    [,55]    [,56]
[1,] 27.48851 36.69952 33.62170 32.69949 28.74757 12.89059 26.32137 16.27648
[2,] 28.07204 37.26819 34.78189 33.83438 29.56855 14.56060 28.11806 17.62786
[3,] 28.21389 37.40094 35.03073 34.07884 29.75524 14.92247 28.49013 17.92777
        [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]    [,64]
[1,] 23.17780 31.21281 39.27708 36.82702 22.21980 29.18595 33.24266 20.40352
[2,] 23.55482 31.77339 39.99898 37.88345 23.80732 30.89902 33.71999 21.23928
[3,] 23.66122 31.90784 40.16048 38.11090 24.14338 31.25437 33.83682 21.43753
        [,65]    [,66]    [,67]    [,68]    [,69]    [,70]    [,71]    [,72]
[1,] 33.74659 28.44938 37.07130 32.77425 31.78351 27.20854 30.57213 29.61344
[2,] 34.66157 29.10293 38.14320 33.80115 33.25620 28.93424 32.10660 30.69974
[3,] 34.86320 29.25753 38.37353 34.02485 33.56533 29.29279 32.42791 30.93668
        [,73]    [,74]    [,75]    [,76]    [,77]    [,78]    [,79]    [,80]
[1,] 37.96311 12.98844 12.98844 18.66220 27.75685 31.58018 21.01323 29.00012
[2,] 38.64257 14.69502 14.69502 19.96937 28.57694 32.07757 22.77865 29.89818
[3,] 38.79637 15.06295 15.06295 20.25772 28.76424 32.19943 23.14798 30.09950
        [,81]    [,82]    [,83]    [,84]    [,85]    [,86]    [,87]    [,88]
[1,] 14.65597 18.99693 33.35526 31.16560 26.21219 27.10166 28.90280 36.36276
[2,] 16.17108 20.40725 33.96907 31.93374 28.04743 27.97143 30.05298 37.41852
[3,] 16.50288 20.71401 34.11249 32.10853 28.42665 28.16879 30.30254 37.64605
        [,89]    [,90]    [,91]    [,92]    [,93]    [,94]    [,95]    [,96]
[1,] 38.34602 32.17667 33.54567 34.48118 18.03008 23.04029 30.62485 21.68743
[2,] 39.21427 32.98899 34.51957 35.57410 19.00745 23.83199 32.05881 22.26499
[3,] 39.40466 33.17168 34.73267 35.80963 19.23599 24.01844 32.36116 22.41220
        [,97]    [,98]    [,99]   [,100]   [,101]   [,102]   [,103]   [,104]
[1,] 34.69841 35.48650 32.18757 34.56323 31.10692 31.16667 37.05019 37.03842
[2,] 35.10866 36.51040 33.64709 35.58076 32.55925 32.91713 38.25723 38.14684
[3,] 35.21145 36.73218 33.95356 35.80175 32.86483 33.27872 38.51358 38.38423
       [,105]   [,106]   [,107]   [,108]   [,109]   [,110]   [,111]   [,112]
[1,] 35.62991 34.12898 38.90208 41.20254 32.17667 28.61636 20.34747 18.60950
[2,] 36.14020 35.16653 39.77107 41.99134 32.98899 29.40770 21.46260 19.52206
[3,] 36.26209 35.39158 39.96137 42.16512 33.17168 29.58879 21.71331 19.73753
       [,113]   [,114]   [,115]   [,116]   [,117]   [,118]   [,119]   [,120]
[1,] 29.89205 12.04955 37.80103 17.45963 36.17525 35.69670 36.49070 36.49070
[2,] 31.36932 13.86909 38.55355 18.91100 37.36207 36.82608 37.62031 37.62031
[3,] 31.68018 14.25776 38.72167 19.22715 37.61488 37.06807 37.86200 37.86200
       [,121]   [,122]   [,123]   [,124]   [,125]   [,126]   [,127]   [,128]
[1,] 17.34916 28.01086 22.43183 24.05271 23.17308 37.06122 25.52654 29.48077
[2,] 18.27324 29.81139 22.94196 24.29549 24.05891 37.64966 25.96138 31.24058
[3,] 18.49310 30.18346 23.07516 24.37455 24.26313 37.78610 26.07626 31.60451
       [,129]   [,130]   [,131]   [,132]   [,133]   [,134]   [,135]   [,136]
[1,] 35.89794 31.98902 15.23040 30.93482 35.23750 32.89720 15.56551 27.08984
[2,] 36.95795 33.00272 16.83419 32.59990 36.28699 34.04616 17.15271 28.85565
[3,] 37.18650 33.22433 17.18066 32.94558 36.51382 34.29321 17.49576 29.22168
       [,137]   [,138]   [,139]   [,140]   [,141]   [,142]   [,143]   [,144]
[1,] 25.19012 20.05422 34.46591 29.50978 37.84669 37.84669 29.79872 37.75358
[2,] 25.91580 21.74642 35.57841 30.22865 38.43377 38.43377 30.67406 38.44764
[3,] 26.08728 22.10326 35.81770 30.39507 38.56956 38.56956 30.87046 38.60439
       [,145]   [,146]   [,147]   [,148]   [,149]   [,150]   [,151]   [,152]
[1,] 27.05142 31.11986 34.89548 39.33476 38.51923 32.76404 26.98709 29.20608
[2,] 27.69858 31.74137 35.40716 40.07805 39.20251 33.19370 27.39986 30.24632
[3,] 27.85315 31.88774 35.52972 40.24370 39.35680 33.30149 27.50895 30.47473
       [,153]   [,154]   [,155]   [,156]   [,157]   [,158]   [,159]   [,160]
[1,] 20.86701 34.46351 37.98781 29.27559 21.67876 35.96049 37.57229 31.53325
[2,] 22.52542 35.07822 38.45059 30.26274 23.50358 37.11882 38.62512 33.22531
[3,] 22.87547 35.22117 38.56193 30.48095 23.88322 37.36625 38.85157 33.57583
       [,161]   [,162]   [,163]   [,164]   [,165]   [,166]   [,167]   [,168]
[1,] 13.43597 22.31787 21.41356 13.70855 40.78439 27.45701 27.85269 28.21615
[2,] 15.19614 23.93994 23.03143 15.47890 41.53600 29.20371 29.61167 29.93903
[3,] 15.57248 24.28224 23.37366 15.85657 41.70269 29.56604 29.97610 30.29661
       [,169]   [,170]   [,171]   [,172]   [,173]   [,174]   [,175]   [,176]
[1,] 33.04100 12.31534 32.76533 31.60797 30.40930 21.54997 33.29591 31.27343
[2,] 33.90144 14.17265 33.74348 33.14272 31.26026 23.31276 34.31163 32.82311
[3,] 34.09292 14.56720 33.95783 33.46364 31.45154 23.68124 34.53291 33.14698
       [,177]   [,178]   [,179]   [,180]   [,181]   [,182]   [,183]   [,184]
[1,] 36.83761 17.10107 39.25696 24.31659 21.94315 30.94398 29.43842 31.06326
[2,] 37.43434 18.48498 39.93810 24.66071 23.47479 31.88100 31.19075 32.64557
[3,] 37.57252 18.78947 40.09165 24.75927 23.80081 32.08850 31.55331 32.97566
       [,185]   [,186]   [,187]   [,188]   [,189]   [,190]   [,191]   [,192]
[1,] 29.64871 28.37928 37.83639 25.90792 19.62198 21.00867 21.01883 31.65456
[2,] 30.75271 29.46516 38.39813 26.59619 20.31387 22.46673 22.49208 32.39883
[3,] 30.99300 29.70283 38.52896 26.75976 20.48608 22.78008 22.80821 32.56868
       [,193]   [,194]   [,195]   [,196]   [,197]   [,198]   [,199]   [,200]
[1,] 28.44964 37.16599 38.71412 37.90473 28.88252 13.50283 32.16131 31.35505
[2,] 29.29283 37.76214 39.22072 38.41496 29.55317 15.21615 33.14865 31.82170
[3,] 29.48402 37.90004 39.34033 38.53566 29.71074 15.58436 33.36510 31.93770
       [,201]   [,202]   [,203]   [,204]   [,205]   [,206]   [,207]   [,208]
[1,] 17.40399 22.94536 19.43044 18.33697 30.95231 28.05355 30.52485 39.26374
[2,] 18.84920 23.32729 21.18008 19.67518 32.68523 29.02852 31.24122 39.86311
[3,] 19.16432 23.43495 21.54777 19.96964 33.04360 29.24526 31.40642 40.00066
       [,209]   [,210]   [,211]   [,212]   [,213]   [,214]   [,215]   [,216]
[1,] 34.67650 27.19356 35.61145 27.86042 23.86047 27.27085 20.64180 31.84548
[2,] 35.09424 27.98248 36.66724 29.02429 24.10970 28.96995 22.30833 32.28828
[3,] 35.19850 28.16425 36.89510 29.27714 24.19026 29.32354 22.66003 32.39927
       [,217]   [,218]   [,219]   [,220]   [,221]   [,222]   [,223]   [,224]
[1,] 30.67242 17.99749 16.41756 35.53897 23.49739 40.88811 36.35954 29.38681
[2,] 32.12938 18.92311 17.48535 36.62999 23.95864 41.68566 36.98671 30.42459
[3,] 32.43605 19.14208 17.73352 36.86466 24.08100 41.86126 37.13107 30.65240
       [,225]   [,226]   [,227]   [,228]   [,229]   [,230]   [,231]   [,232]
[1,] 18.68947 30.80945 40.13834 40.48913 36.02980 28.43464 19.98037 26.28247
[2,] 20.24923 31.22154 40.86813 41.18300 37.13954 30.20494 20.63253 28.08229
[3,] 20.58345 31.32726 41.03081 41.33853 37.37760 30.57124 20.79660 28.45495
       [,233]   [,234]   [,235]   [,236]   [,237]   [,238]   [,239]   [,240]
[1,] 15.97888 24.12396 31.08449 36.78309 21.20815 28.31804 40.43005 18.79843
[2,] 17.51861 24.52562 31.64784 37.84424 22.74130 29.18984 41.24655 20.20200
[3,] 17.85265 24.63563 31.78292 38.07262 23.06822 29.38662 41.42602 20.50778
       [,241]   [,242]   [,243]   [,244]   [,245]   [,246]   [,247]   [,248]
[1,] 34.15854 32.96311 15.90278 22.94778 37.53636 14.74263 13.01169 16.46752
[2,] 35.09907 33.98640 17.53346 23.79027 38.26492 16.10984 14.64176 18.03107
[3,] 35.30542 34.20931 17.88371 23.98649 38.42849 16.41534 14.99656 18.36865
       [,249]   [,250]   [,251]   [,252]   [,253]   [,254]   [,255]   [,256]
[1,] 11.98952 17.88194 20.24564 29.02410 40.39416 33.37806 31.16560 26.61788
[2,] 13.81096 18.60177 22.02854 29.92858 41.15927 33.98333 31.93374 28.45421
[3,] 14.20005 18.78239 22.40158 30.13112 41.32874 34.12508 32.10853 28.83345
       [,257]   [,258]   [,259]   [,260]   [,261]   [,262]   [,263]   [,264]
[1,] 27.72989 39.56355 32.24084 33.47458 34.20885 18.46159 22.78867 22.95693
[2,] 28.84919 40.34896 33.06409 34.45319 35.28345 19.25849 23.70264 23.86110
[3,] 29.09367 40.52272 33.24885 34.66723 35.51558 19.45254 23.91262 24.06903
       [,265]   [,266]   [,267]   [,268]   [,269]   [,270]   [,271]   [,272]
[1,] 30.09801 19.00712 40.02139 34.82677 31.48926 31.97107 28.18269 18.50530
[2,] 31.58283 19.80552 40.71135 35.82378 32.92341 33.50841 28.81679 19.27845
[3,] 31.89501 19.99891 40.86630 36.04068 33.22539 33.82967 28.96784 19.46795
       [,273]   [,274]   [,275]   [,276]   [,277]   [,278]   [,279]   [,280]
[1,] 30.47815 25.57820 40.88811 40.88811 32.24084 33.10827 30.94422 27.13479
[2,] 31.91016 25.93011 41.68566 41.68566 33.06409 34.23020 31.87527 28.26188
[3,] 32.21221 26.02875 41.86126 41.86126 33.24885 34.47196 32.08162 28.50827
       [,281]   [,282]   [,283]   [,284]   [,285]   [,286]   [,287]   [,288]
[1,] 29.16336 36.75794 23.02032 21.92938 27.49290 27.92249 21.29526 14.21576
[2,] 30.35501 37.85703 23.49333 22.50786 28.36829 28.82333 23.03569 15.87583
[3,] 30.61228 38.09274 23.61856 22.65491 28.56641 29.02599 23.40031 16.23370
       [,289]   [,290]   [,291]   [,292]   [,293]   [,294]   [,295]   [,296]
[1,] 27.93624 19.18883 27.02220 30.59601 34.96938 31.25049 31.25049 25.23080
[2,] 29.73261 20.02354 27.48511 32.28064 36.00442 32.25685 32.25685 25.95350
[3,] 30.10393 20.22346 27.60394 32.63012 36.22859 32.47748 32.47748 26.12436
       [,297]   [,298]   [,299]   [,300]   [,301]   [,302]   [,303]   [,304]
[1,] 26.92407 28.92481 37.04184 29.61250 37.92617 31.13550 37.82805 25.35015
[2,] 28.64225 30.62665 37.75036 30.32248 38.51160 31.94847 38.52330 26.10154
[3,] 28.99953 30.98002 37.91026 30.48710 38.64703 32.13194 38.68025 26.27779
       [,305]   [,306]   [,307]   [,308]   [,309]   [,310]   [,311]   [,312]
[1,] 23.25366 34.75234 19.27779 38.53332 32.35390 32.51710 36.89970 38.17518
[2,] 24.02938 35.18049 20.80860 39.21270 32.81613 32.98143 37.38176 38.62291
[3,] 24.21253 35.28676 21.13695 39.36623 32.93058 33.09618 37.49744 38.73120
       [,313]   [,314]   [,315]   [,316]   [,317]   [,318]   [,319]   [,320]
[1,] 21.39518 35.90521 21.67765 14.29900 27.90698 27.61600 28.55461 28.55461
[2,] 23.20847 36.32610 23.32507 16.11695 28.89324 29.31161 30.27227 30.27227
[3,] 23.58621 36.43029 23.67249 16.50197 29.11225 29.66439 30.62873 30.62873
       [,321]   [,322]   [,323]   [,324]   [,325]   [,326]   [,327]   [,328]
[1,] 32.80869 28.86657 30.45193 31.56374 15.14982 15.64048 35.68495 32.98510
[2,] 33.79511 30.03286 31.99601 33.09094 16.68309 17.21328 36.85270 33.84064
[3,] 34.01102 30.28549 32.31918 33.41045 17.01726 17.55368 37.10206 34.03121
       [,329]   [,330]   [,331]   [,332]   [,333]   [,334]   [,335]   [,336]
[1,] 22.18457 30.48986 29.27658 20.14950 19.62198 26.07837 30.80945 28.06569
[2,] 23.80323 31.33652 30.43595 20.81508 20.31387 26.81867 31.22154 29.11391
[3,] 24.14501 31.52692 30.68702 20.98143 20.48608 26.99209 31.32726 29.34463
       [,337]   [,338]   [,339]   [,340]   [,341]   [,342]   [,343]   [,344]
[1,] 22.94778 20.93986 17.57960 30.24302 22.95693 18.50530 27.92249 14.21576
[2,] 23.79027 22.59888 19.03802 31.11308 23.86110 19.27845 28.82333 15.87583
[3,] 23.98649 22.94898 19.35529 31.30815 24.06903 19.46795 29.02599 16.23370
       [,345]   [,346]   [,347]   [,348]   [,349]   [,350]   [,351]   [,352]
[1,] 27.02220 26.92407 29.39025 25.35015 38.59608 36.89970 34.99340 30.31541
[2,] 27.48511 28.64225 30.12724 26.10154 39.46447 37.38176 35.40942 31.83254
[3,] 27.60394 28.99953 30.29725 26.27779 39.65478 37.49744 35.51316 32.15071
       [,353]   [,354]   [,355]   [,356]   [,357]   [,358]   [,359]   [,360]
[1,] 29.77940 20.24284 27.83633 30.12894 36.83340 30.30280 39.34599 20.10602
[2,] 30.93936 21.30385 29.65392 30.78057 37.53383 31.41508 39.90869 21.70829
[3,] 31.19023 21.54462 30.02921 30.93350 37.69225 31.65654 40.03901 22.04879
       [,361]   [,362]   [,363]   [,364]   [,365]   [,366]   [,367]   [,368]
[1,] 24.18198 34.02357 28.19057 38.36473 29.23801 30.73994 18.75047 27.45526
[2,] 24.60628 35.11732 29.29634 39.14594 29.88158 31.46510 20.24862 28.03525
[3,] 24.72062 35.35323 29.53793 39.31940 30.03362 31.63186 20.57162 28.17644
       [,369]   [,370]   [,371]   [,372]   [,373]   [,374]   [,375]   [,376]
[1,] 36.72946 33.60477 32.63360 28.81059 12.92844 39.28562 36.87630 37.05955
[2,] 37.29689 34.76592 33.76548 29.62815 14.60494 40.00625 37.92786 38.13236
[3,] 37.42939 35.01496 34.00939 29.81413 14.96783 40.16750 38.15435 38.36287
       [,377]   [,378]   [,379]   [,380]   [,381]   [,382]   [,383]   [,384]
[1,] 31.79029 29.54813 37.93550 13.04023 20.97948 28.92381 38.34642 30.62904
[2,] 33.26541 30.63089 38.61675 14.74961 22.74909 30.07815 39.21496 32.05932
[3,] 33.57499 30.86719 38.77091 15.11793 23.11921 30.32849 39.40541 32.36097
       [,385]   [,386]   [,387]   [,388]   [,389]   [,390]   [,391]   [,392]
[1,] 32.19454 34.58313 31.25126 37.13689 37.09736 18.63065 17.40583 36.52444
[2,] 33.65317 35.59799 33.00314 38.34326 38.20849 19.54029 18.86461 37.65775
[3,] 33.95947 35.81845 33.36496 38.59944 38.44638 19.75518 19.18216 37.90014
       [,393]   [,394]   [,395]   [,396]   [,397]   [,398]   [,399]   [,400]
[1,] 36.21893 35.71809 36.52444 29.55052 30.99204 32.85928 15.51804 34.44272
[2,] 37.40727 36.85071 37.65775 31.31373 32.65989 34.00703 17.09699 35.56072
[3,] 37.66035 37.09330 37.90014 31.67828 33.00607 34.25387 17.43865 35.80109
       [,401]   [,402]   [,403]   [,404]   [,405]   [,406]   [,407]   [,408]
[1,] 38.45866 37.99787 35.95815 37.58340 31.53410 22.31776 21.42543 13.74165
[2,] 39.14416 38.45691 37.12106 38.64236 33.22416 23.93681 23.04610 15.51760
[3,] 39.29891 38.56751 37.36938 38.86999 33.57431 24.27856 23.38884 15.89618
       [,409]   [,410]
[1,] 31.30908 21.97093
[2,] 32.86203 23.49935
[3,] 33.18651 23.82476</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>distance_matrix_km_numeric <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(distance_matrix_km), <span class="at">nrow =</span> <span class="fu">nrow</span>(distance_matrix_km), <span class="at">ncol =</span> <span class="fu">ncol</span>(distance_matrix_km))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1">
<h1>5 Exploratory Data Analysis (EDA)</h1>
<p>Let’s start by counting the number of schools in each region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mpsz<span class="sc">$</span><span class="st">`</span><span class="at">Sch Count</span><span class="st">`</span><span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(mpsz, schools_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To list the zone with the most number of schools:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">top_n</span>(mpsz, <span class="dv">1</span>, <span class="st">`</span><span class="at">Sch Count</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37
Projected CRS: SVY21 / Singapore TM
  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C
1      142          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM
     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng
1 EAST REGION       ER 21658EAAF84F4D8D 2016-05-11 41122.55 37392.39   10180.62
  SHAPE_Area                       geometry Sch Count
1    4339824 MULTIPOLYGON (((42196.76 38...        13</code></pre>
</div>
</div>
<p>We will also calculate the density of schools in that area:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mpsz<span class="sc">$</span>Area <span class="ot">&lt;-</span> mpsz <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_area</span>()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> mpsz <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Sch Density</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Sch Count</span><span class="st">`</span><span class="sc">/</span>Area <span class="sc">*</span><span class="dv">1000000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpsz, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Sch Density</span><span class="st">`</span>)))<span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Are schools evenly distributed in Singapore?"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="st">"Most sub-zones only have one school."</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"School density (per km sq)"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modelling-and-visualizing-accessibility-using-hansen-method" class="level1">
<h1>7 Modelling and Visualizing Accessibility using Hansen Method</h1>
</section>
<section id="computing-hansens-accessibility" class="level1">
<h1>7.1 Computing Hansen’s Accessibility</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>acc_Hansen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">ac</span>(hexagons<span class="sc">$</span>demand,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                            schools_sf<span class="sc">$</span>capacity,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">D =</span> distance_matrix_km_numeric, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">d0 =</span> <span class="dv">50</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">power =</span> <span class="dv">2</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family =</span> <span class="st">"Hansen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will rename the default field name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(acc_Hansen) <span class="ot">&lt;-</span> <span class="st">"accHansen"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>acc_Hansen <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(acc_Hansen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we will bind the acc_Hansen tibble data frame with the hexagons simple feature data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>hexagon_Hansen <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(hexagons, acc_Hansen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualizing-hansens-accessibility" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-hansens-accessibility">7.2 Visualizing Hansen’s Accessibility</h2>
<section id="extracting-map-extend" class="level3">
<h3 class="anchored" data-anchor-id="extracting-map-extend">7.2.1 Extracting Map Extend</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mapex <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(hexagons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon_Hansen,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bbox =</span> mapex) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"accHansen"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">10</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">border.col =</span> <span class="st">"black"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">border.lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(schools_sf) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Accessibility to Schools: Hansen method"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">2</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">3.0</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.format =</span> <span class="fu">list</span>(<span class="at">digits =</span> <span class="dv">6</span>),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">width =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="statistical-graphic-visualization" class="level2">
<h2 class="anchored" data-anchor-id="statistical-graphic-visualization">7.3 Statistical Graphic Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>hexagon_Hansen <span class="ot">&lt;-</span> <span class="fu">st_join</span>(hexagon_Hansen, mpsz, <span class="at">join =</span> st_intersects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>hexagon_Hansen, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">log</span>(accHansen), </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span> REGION_N)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">"summary"</span>, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">fun.y=</span><span class="st">"mean"</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span><span class="st">"red"</span>, </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Russell Tio</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/russelltio/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>