{
  "hash": "19fb3ee2234f52bf646e490a00209f46",
  "result": {
    "markdown": "---\ntitle: \"Application of Spatial and Spatio-temporal Analysis Methods to Discover the Distribution of Dengue Fever in Tainan City, Taiwan\"\nsubtitle: \"Take-home_Ex03\"\nformat:\n  html:\n    code-fold: false\n    code-summary: \"Show the code\"\n    toc: true # Table of Contents\nexecute:\n  eval: true\n  echo: true\n  freeze: true\n  warning: False  # This turns off warning messages being displayed\ndate: 20 March, 2024\ndate-modified: \"last-modified\"\n---\n\n\n# 1 Introduction\n\n# 2 The Data\n\n# 3 Getting Started\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tmap, SpatialAcc, sf, ggstatsplot, reshape2, tidyverse)\n```\n:::\n\n\n# 4 Data Wrangling\n\n## 4.1 Importing geospatial data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_read(dsn=\"data/geospatial\", layer = \"MP14_SUBZONE_NO_SEA_PL\") %>%\n  st_transform(3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `MP14_SUBZONE_NO_SEA_PL' from data source \n  `C:\\russelltjh\\IS415-GAA\\Take-home_Ex\\Take-home_Ex03\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagons <- st_read(dsn = \"data/geospatial\", layer=\"hexagons\") %>%\n  st_transform(3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `hexagons' from data source \n  `C:\\russelltjh\\IS415-GAA\\Take-home_Ex\\Take-home_Ex03\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3125 features and 6 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 21506.33 xmax: 50010.26 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n```\n:::\n:::\n\n\n## 4.2 Aspatial Data Wrangling\n\n\n::: {.cell}\n\n```{.r .cell-code}\nschools <- read_csv(\"data/aspatial/school_coordinates.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nschools_sf <- st_as_sf(schools,\n                       coords = c(\"Longitude\", \"Latitude\"),\n                       crs=4326) %>%\n  st_transform(3414)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nschools_sf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 410 features and 5 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 11750.82 ymin: 28603.93 xmax: 42410.51 ymax: 48769.53\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 410 × 6\n    ...1 SCHOOL                    AREA  TYPE  ADDRESS            geometry\n * <dbl> <chr>                     <chr> <chr> <chr>           <POINT [m]>\n 1     0 Admiralty Primary School  Wood… Prim… 11 WOO… (24296.62 47144.77)\n 2     1 Ahmad Ibrahim Primary Sc… Yish… Prim… 10 YIS… (27958.14 46096.26)\n 3     2 Ai Tong School            Bish… Prim… 100 BR… (27966.81 38071.92)\n 4     3 Alexandra Primary School  Buki… Prim… 2A PRI… (27010.19 30414.72)\n 5     4 Anchor Green Primary Sch… Seng… Prim… 31 ANC… (33992.45 41365.63)\n 6     5 Anderson Primary School   Ang … Prim… 19 ANG… (28898.48 40690.43)\n 7     6 Ang Mo Kio Primary School Ang … Prim… 20 ANG… (28702.49 39038.16)\n 8     7 Anglo-Chinese School (Ju… Cent… Prim… 16 WIN… (28916.31 32403.75)\n 9     8 Anglo-Chinese School (Pr… Buki… Prim… 50 BAR… (28254.98 33404.23)\n10     9 Angsana Primary School    Tamp… Prim… 3 TAMP… (41160.87 36732.32)\n# ℹ 400 more rows\n```\n:::\n:::\n\n\n## 4.3 Cleaning and updating attribute fields of the geospatial data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nschools_sf <- schools_sf %>% \n  select(...1, SCHOOL) %>%\n  mutate(capacity = 100)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagons <- hexagons %>%\n  select(fid) %>%\n  mutate(demand = 100)\n```\n:::\n\n\n## 4.4 Getting centroid points from hexagon\n\nWe need to get the centroid of the hexagon so that we can use it to calculate the euclidean distance from each school later.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagon_points <- st_centroid(hexagons)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagon_points\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 3125 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 2956.213 ymin: 21756.33 xmax: 49721.58 ymax: 50006.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n   fid                  geometry demand\n1    1 POINT (2956.213 27506.33)    100\n2    2 POINT (2956.213 25006.33)    100\n3    3 POINT (2956.213 24506.33)    100\n4    4 POINT (2956.213 24006.33)    100\n5    5 POINT (2956.213 23506.33)    100\n6    6 POINT (2956.213 23006.33)    100\n7    7 POINT (3389.226 28756.33)    100\n8    8 POINT (3389.226 28256.33)    100\n9    9 POINT (3389.226 27756.33)    100\n10  10 POINT (3389.226 27256.33)    100\n```\n:::\n:::\n\n\n## 4.5 Get Distance Matrix\n\nBased on the hexagon centroids and location of the schools, we will generate a distance matrix.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistance_matrix <- st_distance(hexagon_points, schools_sf, by_element = FALSE) \nhead(distance_matrix, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nUnits: [m]\n         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]\n[1,] 29001.40 31155.76 27150.71 24229.16 33990.12 29100.20 28210.88 26418.02\n[2,] 30749.36 32709.04 28217.71 24654.50 35083.82 30314.88 29321.71 26993.49\n[3,] 31111.28 33033.64 28452.68 24768.99 35319.74 30576.56 29564.24 27134.78\n         [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]\n[1,] 25977.16 39302.85 22616.77 37244.72 29295.31 22329.67 14473.01 21577.25\n[2,] 26656.19 39963.66 24156.05 37758.66 29930.88 22605.19 16085.33 23062.19\n[3,] 26817.91 40113.22 24482.94 37880.41 30081.32 22692.96 16434.47 23379.95\n        [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]\n[1,] 19369.41 18483.92 30945.75 31238.86 25809.05 40587.62 28053.55 30757.54\n[2,] 20527.53 19813.99 32662.59 31877.58 26040.91 41388.42 29028.52 31484.68\n[3,] 20787.50 20106.76 33017.96 32027.22 26115.77 41564.78 29245.26 31651.81\n        [,25]    [,26]    [,27]    [,28]    [,29]    [,30]    [,31]    [,32]\n[1,] 39153.89 34011.07 24494.34 30237.68 34348.78 20970.44 27050.07 27860.42\n[2,] 39759.96 34437.22 24733.50 31171.33 35298.01 22409.06 27845.96 29024.29\n[3,] 39898.87 34543.54 24811.30 31378.63 35505.93 22718.88 28029.19 29277.14\n        [,33]    [,34]    [,35]    [,36]    [,37]    [,38]    [,39]    [,40]\n[1,] 32053.42 39342.58 19397.71 18100.28 35255.81 19134.81 14577.77 35691.88\n[2,] 33608.88 40018.22 21091.37 19013.98 36342.43 20883.04 16318.44 36319.41\n[3,] 33933.53 40170.66 21449.03 19230.55 36576.39 21250.73 16689.74 36464.20\n        [,41]    [,42]    [,43]    [,44]    [,45]    [,46]    [,47]    [,48]\n[1,] 18755.84 20761.96 40505.36 36497.07 39393.14 31282.12 28672.81 20102.33\n[2,] 20250.54 22561.12 41175.19 37590.84 40231.82 33004.82 30453.44 20736.10\n[3,] 20572.92 22936.72 41326.01 37825.64 40416.03 33361.17 30821.56 20896.47\n        [,49]    [,50]    [,51]    [,52]    [,53]    [,54]    [,55]    [,56]\n[1,] 27488.51 36699.52 33621.70 32699.49 28747.57 12890.59 26321.37 16276.48\n[2,] 28072.04 37268.19 34781.89 33834.38 29568.55 14560.60 28118.06 17627.86\n[3,] 28213.89 37400.94 35030.73 34078.84 29755.24 14922.47 28490.13 17927.77\n        [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]    [,64]\n[1,] 23177.80 31212.81 39277.08 36827.02 22219.80 29185.95 33242.66 20403.52\n[2,] 23554.82 31773.39 39998.98 37883.45 23807.32 30899.02 33719.99 21239.28\n[3,] 23661.22 31907.84 40160.48 38110.90 24143.38 31254.37 33836.82 21437.53\n        [,65]    [,66]    [,67]    [,68]    [,69]    [,70]    [,71]    [,72]\n[1,] 33746.59 28449.38 37071.30 32774.25 31783.51 27208.54 30572.13 29613.44\n[2,] 34661.57 29102.93 38143.20 33801.15 33256.20 28934.24 32106.60 30699.74\n[3,] 34863.20 29257.53 38373.53 34024.85 33565.33 29292.79 32427.91 30936.68\n        [,73]    [,74]    [,75]    [,76]    [,77]    [,78]    [,79]    [,80]\n[1,] 37963.11 12988.44 12988.44 18662.20 27756.85 31580.18 21013.23 29000.12\n[2,] 38642.57 14695.02 14695.02 19969.37 28576.94 32077.57 22778.65 29898.18\n[3,] 38796.37 15062.95 15062.95 20257.72 28764.24 32199.43 23147.98 30099.50\n        [,81]    [,82]    [,83]    [,84]    [,85]    [,86]    [,87]    [,88]\n[1,] 14655.97 18996.93 33355.26 31165.60 26212.19 27101.66 28902.80 36362.76\n[2,] 16171.08 20407.25 33969.07 31933.74 28047.43 27971.43 30052.98 37418.52\n[3,] 16502.88 20714.01 34112.49 32108.53 28426.65 28168.79 30302.54 37646.05\n        [,89]    [,90]    [,91]    [,92]    [,93]    [,94]    [,95]    [,96]\n[1,] 38346.02 32176.67 33545.67 34481.18 18030.08 23040.29 30624.85 21687.43\n[2,] 39214.27 32988.99 34519.57 35574.10 19007.45 23831.99 32058.81 22264.99\n[3,] 39404.66 33171.68 34732.67 35809.63 19235.99 24018.44 32361.16 22412.20\n        [,97]    [,98]    [,99]   [,100]   [,101]   [,102]   [,103]   [,104]\n[1,] 34698.41 35486.50 32187.57 34563.23 31106.92 31166.67 37050.19 37038.42\n[2,] 35108.66 36510.40 33647.09 35580.76 32559.25 32917.13 38257.23 38146.84\n[3,] 35211.45 36732.18 33953.56 35801.75 32864.83 33278.72 38513.58 38384.23\n       [,105]   [,106]   [,107]   [,108]   [,109]   [,110]   [,111]   [,112]\n[1,] 35629.91 34128.98 38902.08 41202.54 32176.67 28616.36 20347.47 18609.50\n[2,] 36140.20 35166.53 39771.07 41991.34 32988.99 29407.70 21462.60 19522.06\n[3,] 36262.09 35391.58 39961.37 42165.12 33171.68 29588.79 21713.31 19737.53\n       [,113]   [,114]   [,115]   [,116]   [,117]   [,118]   [,119]   [,120]\n[1,] 29892.05 12049.55 37801.03 17459.63 36175.25 35696.70 36490.70 36490.70\n[2,] 31369.32 13869.09 38553.55 18911.00 37362.07 36826.08 37620.31 37620.31\n[3,] 31680.18 14257.76 38721.67 19227.15 37614.88 37068.07 37862.00 37862.00\n       [,121]   [,122]   [,123]   [,124]   [,125]   [,126]   [,127]   [,128]\n[1,] 17349.16 28010.86 22431.83 24052.71 23173.08 37061.22 25526.54 29480.77\n[2,] 18273.24 29811.39 22941.96 24295.49 24058.91 37649.66 25961.38 31240.58\n[3,] 18493.10 30183.46 23075.16 24374.55 24263.13 37786.10 26076.26 31604.51\n       [,129]   [,130]   [,131]   [,132]   [,133]   [,134]   [,135]   [,136]\n[1,] 35897.94 31989.02 15230.40 30934.82 35237.50 32897.20 15565.51 27089.84\n[2,] 36957.95 33002.72 16834.19 32599.90 36286.99 34046.16 17152.71 28855.65\n[3,] 37186.50 33224.33 17180.66 32945.58 36513.82 34293.21 17495.76 29221.68\n       [,137]   [,138]   [,139]   [,140]   [,141]   [,142]   [,143]   [,144]\n[1,] 25190.12 20054.22 34465.91 29509.78 37846.69 37846.69 29798.72 37753.58\n[2,] 25915.80 21746.42 35578.41 30228.65 38433.77 38433.77 30674.06 38447.64\n[3,] 26087.28 22103.26 35817.70 30395.07 38569.56 38569.56 30870.46 38604.39\n       [,145]   [,146]   [,147]   [,148]   [,149]   [,150]   [,151]   [,152]\n[1,] 27051.42 31119.86 34895.48 39334.76 38519.23 32764.04 26987.09 29206.08\n[2,] 27698.58 31741.37 35407.16 40078.05 39202.51 33193.70 27399.86 30246.32\n[3,] 27853.15 31887.74 35529.72 40243.70 39356.80 33301.49 27508.95 30474.73\n       [,153]   [,154]   [,155]   [,156]   [,157]   [,158]   [,159]   [,160]\n[1,] 20867.01 34463.51 37987.81 29275.59 21678.76 35960.49 37572.29 31533.25\n[2,] 22525.42 35078.22 38450.59 30262.74 23503.58 37118.82 38625.12 33225.31\n[3,] 22875.47 35221.17 38561.93 30480.95 23883.22 37366.25 38851.57 33575.83\n       [,161]   [,162]   [,163]   [,164]   [,165]   [,166]   [,167]   [,168]\n[1,] 13435.97 22317.87 21413.56 13708.55 40784.39 27457.01 27852.69 28216.15\n[2,] 15196.14 23939.94 23031.43 15478.90 41536.00 29203.71 29611.67 29939.03\n[3,] 15572.48 24282.24 23373.66 15856.57 41702.69 29566.04 29976.10 30296.61\n       [,169]   [,170]   [,171]   [,172]   [,173]   [,174]   [,175]   [,176]\n[1,] 33041.00 12315.34 32765.33 31607.97 30409.30 21549.97 33295.91 31273.43\n[2,] 33901.44 14172.65 33743.48 33142.72 31260.26 23312.76 34311.63 32823.11\n[3,] 34092.92 14567.20 33957.83 33463.64 31451.54 23681.24 34532.91 33146.98\n       [,177]   [,178]   [,179]   [,180]   [,181]   [,182]   [,183]   [,184]\n[1,] 36837.61 17101.07 39256.96 24316.59 21943.15 30943.98 29438.42 31063.26\n[2,] 37434.34 18484.98 39938.10 24660.71 23474.79 31881.00 31190.75 32645.57\n[3,] 37572.52 18789.47 40091.65 24759.27 23800.81 32088.50 31553.31 32975.66\n       [,185]   [,186]   [,187]   [,188]   [,189]   [,190]   [,191]   [,192]\n[1,] 29648.71 28379.28 37836.39 25907.92 19621.98 21008.67 21018.83 31654.56\n[2,] 30752.71 29465.16 38398.13 26596.19 20313.87 22466.73 22492.08 32398.83\n[3,] 30993.00 29702.83 38528.96 26759.76 20486.08 22780.08 22808.21 32568.68\n       [,193]   [,194]   [,195]   [,196]   [,197]   [,198]   [,199]   [,200]\n[1,] 28449.64 37165.99 38714.12 37904.73 28882.52 13502.83 32161.31 31355.05\n[2,] 29292.83 37762.14 39220.72 38414.96 29553.17 15216.15 33148.65 31821.70\n[3,] 29484.02 37900.04 39340.33 38535.66 29710.74 15584.36 33365.10 31937.70\n       [,201]   [,202]   [,203]   [,204]   [,205]   [,206]   [,207]   [,208]\n[1,] 17403.99 22945.36 19430.44 18336.97 30952.31 28053.55 30524.85 39263.74\n[2,] 18849.20 23327.29 21180.08 19675.18 32685.23 29028.52 31241.22 39863.11\n[3,] 19164.32 23434.95 21547.77 19969.64 33043.60 29245.26 31406.42 40000.66\n       [,209]   [,210]   [,211]   [,212]   [,213]   [,214]   [,215]   [,216]\n[1,] 34676.50 27193.56 35611.45 27860.42 23860.47 27270.85 20641.80 31845.48\n[2,] 35094.24 27982.48 36667.24 29024.29 24109.70 28969.95 22308.33 32288.28\n[3,] 35198.50 28164.25 36895.10 29277.14 24190.26 29323.54 22660.03 32399.27\n       [,217]   [,218]   [,219]   [,220]   [,221]   [,222]   [,223]   [,224]\n[1,] 30672.42 17997.49 16417.56 35538.97 23497.39 40888.11 36359.54 29386.81\n[2,] 32129.38 18923.11 17485.35 36629.99 23958.64 41685.66 36986.71 30424.59\n[3,] 32436.05 19142.08 17733.52 36864.66 24081.00 41861.26 37131.07 30652.40\n       [,225]   [,226]   [,227]   [,228]   [,229]   [,230]   [,231]   [,232]\n[1,] 18689.47 30809.45 40138.34 40489.13 36029.80 28434.64 19980.37 26282.47\n[2,] 20249.23 31221.54 40868.13 41183.00 37139.54 30204.94 20632.53 28082.29\n[3,] 20583.45 31327.26 41030.81 41338.53 37377.60 30571.24 20796.60 28454.95\n       [,233]   [,234]   [,235]   [,236]   [,237]   [,238]   [,239]   [,240]\n[1,] 15978.88 24123.96 31084.49 36783.09 21208.15 28318.04 40430.05 18798.43\n[2,] 17518.61 24525.62 31647.84 37844.24 22741.30 29189.84 41246.55 20202.00\n[3,] 17852.65 24635.63 31782.92 38072.62 23068.22 29386.62 41426.02 20507.78\n       [,241]   [,242]   [,243]   [,244]   [,245]   [,246]   [,247]   [,248]\n[1,] 34158.54 32963.11 15902.78 22947.78 37536.36 14742.63 13011.69 16467.52\n[2,] 35099.07 33986.40 17533.46 23790.27 38264.92 16109.84 14641.76 18031.07\n[3,] 35305.42 34209.31 17883.71 23986.49 38428.49 16415.34 14996.56 18368.65\n       [,249]   [,250]   [,251]   [,252]   [,253]   [,254]   [,255]   [,256]\n[1,] 11989.52 17881.94 20245.64 29024.10 40394.16 33378.06 31165.60 26617.88\n[2,] 13810.96 18601.77 22028.54 29928.58 41159.27 33983.33 31933.74 28454.21\n[3,] 14200.05 18782.39 22401.58 30131.12 41328.74 34125.08 32108.53 28833.45\n       [,257]   [,258]   [,259]   [,260]   [,261]   [,262]   [,263]   [,264]\n[1,] 27729.89 39563.55 32240.84 33474.58 34208.85 18461.59 22788.67 22956.93\n[2,] 28849.19 40348.96 33064.09 34453.19 35283.45 19258.49 23702.64 23861.10\n[3,] 29093.67 40522.72 33248.85 34667.23 35515.58 19452.54 23912.62 24069.03\n       [,265]   [,266]   [,267]   [,268]   [,269]   [,270]   [,271]   [,272]\n[1,] 30098.01 19007.12 40021.39 34826.77 31489.26 31971.07 28182.69 18505.30\n[2,] 31582.83 19805.52 40711.35 35823.78 32923.41 33508.41 28816.79 19278.45\n[3,] 31895.01 19998.91 40866.30 36040.68 33225.39 33829.67 28967.84 19467.95\n       [,273]   [,274]   [,275]   [,276]   [,277]   [,278]   [,279]   [,280]\n[1,] 30478.15 25578.20 40888.11 40888.11 32240.84 33108.27 30944.22 27134.79\n[2,] 31910.16 25930.11 41685.66 41685.66 33064.09 34230.20 31875.27 28261.88\n[3,] 32212.21 26028.75 41861.26 41861.26 33248.85 34471.96 32081.62 28508.27\n       [,281]   [,282]   [,283]   [,284]   [,285]   [,286]   [,287]   [,288]\n[1,] 29163.36 36757.94 23020.32 21929.38 27492.90 27922.49 21295.26 14215.76\n[2,] 30355.01 37857.03 23493.33 22507.86 28368.29 28823.33 23035.69 15875.83\n[3,] 30612.28 38092.74 23618.56 22654.91 28566.41 29025.99 23400.31 16233.70\n       [,289]   [,290]   [,291]   [,292]   [,293]   [,294]   [,295]   [,296]\n[1,] 27936.24 19188.83 27022.20 30596.01 34969.38 31250.49 31250.49 25230.80\n[2,] 29732.61 20023.54 27485.11 32280.64 36004.42 32256.85 32256.85 25953.50\n[3,] 30103.93 20223.46 27603.94 32630.12 36228.59 32477.48 32477.48 26124.36\n       [,297]   [,298]   [,299]   [,300]   [,301]   [,302]   [,303]   [,304]\n[1,] 26924.07 28924.81 37041.84 29612.50 37926.17 31135.50 37828.05 25350.15\n[2,] 28642.25 30626.65 37750.36 30322.48 38511.60 31948.47 38523.30 26101.54\n[3,] 28999.53 30980.02 37910.26 30487.10 38647.03 32131.94 38680.25 26277.79\n       [,305]   [,306]   [,307]   [,308]   [,309]   [,310]   [,311]   [,312]\n[1,] 23253.66 34752.34 19277.79 38533.32 32353.90 32517.10 36899.70 38175.18\n[2,] 24029.38 35180.49 20808.60 39212.70 32816.13 32981.43 37381.76 38622.91\n[3,] 24212.53 35286.76 21136.95 39366.23 32930.58 33096.18 37497.44 38731.20\n       [,313]   [,314]   [,315]   [,316]   [,317]   [,318]   [,319]   [,320]\n[1,] 21395.18 35905.21 21677.65 14299.00 27906.98 27616.00 28554.61 28554.61\n[2,] 23208.47 36326.10 23325.07 16116.95 28893.24 29311.61 30272.27 30272.27\n[3,] 23586.21 36430.29 23672.49 16501.97 29112.25 29664.39 30628.73 30628.73\n       [,321]   [,322]   [,323]   [,324]   [,325]   [,326]   [,327]   [,328]\n[1,] 32808.69 28866.57 30451.93 31563.74 15149.82 15640.48 35684.95 32985.10\n[2,] 33795.11 30032.86 31996.01 33090.94 16683.09 17213.28 36852.70 33840.64\n[3,] 34011.02 30285.49 32319.18 33410.45 17017.26 17553.68 37102.06 34031.21\n       [,329]   [,330]   [,331]   [,332]   [,333]   [,334]   [,335]   [,336]\n[1,] 22184.57 30489.86 29276.58 20149.50 19621.98 26078.37 30809.45 28065.69\n[2,] 23803.23 31336.52 30435.95 20815.08 20313.87 26818.67 31221.54 29113.91\n[3,] 24145.01 31526.92 30687.02 20981.43 20486.08 26992.09 31327.26 29344.63\n       [,337]   [,338]   [,339]   [,340]   [,341]   [,342]   [,343]   [,344]\n[1,] 22947.78 20939.86 17579.60 30243.02 22956.93 18505.30 27922.49 14215.76\n[2,] 23790.27 22598.88 19038.02 31113.08 23861.10 19278.45 28823.33 15875.83\n[3,] 23986.49 22948.98 19355.29 31308.15 24069.03 19467.95 29025.99 16233.70\n       [,345]   [,346]   [,347]   [,348]   [,349]   [,350]   [,351]   [,352]\n[1,] 27022.20 26924.07 29390.25 25350.15 38596.08 36899.70 34993.40 30315.41\n[2,] 27485.11 28642.25 30127.24 26101.54 39464.47 37381.76 35409.42 31832.54\n[3,] 27603.94 28999.53 30297.25 26277.79 39654.78 37497.44 35513.16 32150.71\n       [,353]   [,354]   [,355]   [,356]   [,357]   [,358]   [,359]   [,360]\n[1,] 29779.40 20242.84 27836.33 30128.94 36833.40 30302.80 39345.99 20106.02\n[2,] 30939.36 21303.85 29653.92 30780.57 37533.83 31415.08 39908.69 21708.29\n[3,] 31190.23 21544.62 30029.21 30933.50 37692.25 31656.54 40039.01 22048.79\n       [,361]   [,362]   [,363]   [,364]   [,365]   [,366]   [,367]   [,368]\n[1,] 24181.98 34023.57 28190.57 38364.73 29238.01 30739.94 18750.47 27455.26\n[2,] 24606.28 35117.32 29296.34 39145.94 29881.58 31465.10 20248.62 28035.25\n[3,] 24720.62 35353.23 29537.93 39319.40 30033.62 31631.86 20571.62 28176.44\n       [,369]   [,370]   [,371]   [,372]   [,373]   [,374]   [,375]   [,376]\n[1,] 36729.46 33604.77 32633.60 28810.59 12928.44 39285.62 36876.30 37059.55\n[2,] 37296.89 34765.92 33765.48 29628.15 14604.94 40006.25 37927.86 38132.36\n[3,] 37429.39 35014.96 34009.39 29814.13 14967.83 40167.50 38154.35 38362.87\n       [,377]   [,378]   [,379]   [,380]   [,381]   [,382]   [,383]   [,384]\n[1,] 31790.29 29548.13 37935.50 13040.23 20979.48 28923.81 38346.42 30629.04\n[2,] 33265.41 30630.89 38616.75 14749.61 22749.09 30078.15 39214.96 32059.32\n[3,] 33574.99 30867.19 38770.91 15117.93 23119.21 30328.49 39405.41 32360.97\n       [,385]   [,386]   [,387]   [,388]   [,389]   [,390]   [,391]   [,392]\n[1,] 32194.54 34583.13 31251.26 37136.89 37097.36 18630.65 17405.83 36524.44\n[2,] 33653.17 35597.99 33003.14 38343.26 38208.49 19540.29 18864.61 37657.75\n[3,] 33959.47 35818.45 33364.96 38599.44 38446.38 19755.18 19182.16 37900.14\n       [,393]   [,394]   [,395]   [,396]   [,397]   [,398]   [,399]   [,400]\n[1,] 36218.93 35718.09 36524.44 29550.52 30992.04 32859.28 15518.04 34442.72\n[2,] 37407.27 36850.71 37657.75 31313.73 32659.89 34007.03 17096.99 35560.72\n[3,] 37660.35 37093.30 37900.14 31678.28 33006.07 34253.87 17438.65 35801.09\n       [,401]   [,402]   [,403]   [,404]   [,405]   [,406]   [,407]   [,408]\n[1,] 38458.66 37997.87 35958.15 37583.40 31534.10 22317.76 21425.43 13741.65\n[2,] 39144.16 38456.91 37121.06 38642.36 33224.16 23936.81 23046.10 15517.60\n[3,] 39298.91 38567.51 37369.38 38869.99 33574.31 24278.56 23388.84 15896.18\n       [,409]   [,410]\n[1,] 31309.08 21970.93\n[2,] 32862.03 23499.35\n[3,] 33186.51 23824.76\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndistance_matrix_km <- distance_matrix / 1000\nhead(distance_matrix_km, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nUnits: [m]\n         [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]\n[1,] 29.00140 31.15576 27.15071 24.22916 33.99012 29.10020 28.21088 26.41802\n[2,] 30.74936 32.70904 28.21771 24.65450 35.08382 30.31488 29.32171 26.99349\n[3,] 31.11128 33.03364 28.45268 24.76899 35.31974 30.57656 29.56424 27.13478\n         [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]\n[1,] 25.97716 39.30285 22.61677 37.24472 29.29531 22.32967 14.47301 21.57725\n[2,] 26.65619 39.96366 24.15605 37.75866 29.93088 22.60519 16.08533 23.06219\n[3,] 26.81791 40.11322 24.48294 37.88041 30.08132 22.69296 16.43447 23.37995\n        [,17]    [,18]    [,19]    [,20]    [,21]    [,22]    [,23]    [,24]\n[1,] 19.36941 18.48392 30.94575 31.23886 25.80905 40.58762 28.05355 30.75754\n[2,] 20.52753 19.81399 32.66259 31.87758 26.04091 41.38842 29.02852 31.48468\n[3,] 20.78750 20.10676 33.01796 32.02722 26.11577 41.56478 29.24526 31.65181\n        [,25]    [,26]    [,27]    [,28]    [,29]    [,30]    [,31]    [,32]\n[1,] 39.15389 34.01107 24.49434 30.23768 34.34878 20.97044 27.05007 27.86042\n[2,] 39.75996 34.43722 24.73350 31.17133 35.29801 22.40906 27.84596 29.02429\n[3,] 39.89887 34.54354 24.81130 31.37863 35.50593 22.71888 28.02919 29.27714\n        [,33]    [,34]    [,35]    [,36]    [,37]    [,38]    [,39]    [,40]\n[1,] 32.05342 39.34258 19.39771 18.10028 35.25581 19.13481 14.57777 35.69188\n[2,] 33.60888 40.01822 21.09137 19.01398 36.34243 20.88304 16.31844 36.31941\n[3,] 33.93353 40.17066 21.44903 19.23055 36.57639 21.25073 16.68974 36.46420\n        [,41]    [,42]    [,43]    [,44]    [,45]    [,46]    [,47]    [,48]\n[1,] 18.75584 20.76196 40.50536 36.49707 39.39314 31.28212 28.67281 20.10233\n[2,] 20.25054 22.56112 41.17519 37.59084 40.23182 33.00482 30.45344 20.73610\n[3,] 20.57292 22.93672 41.32601 37.82564 40.41603 33.36117 30.82156 20.89647\n        [,49]    [,50]    [,51]    [,52]    [,53]    [,54]    [,55]    [,56]\n[1,] 27.48851 36.69952 33.62170 32.69949 28.74757 12.89059 26.32137 16.27648\n[2,] 28.07204 37.26819 34.78189 33.83438 29.56855 14.56060 28.11806 17.62786\n[3,] 28.21389 37.40094 35.03073 34.07884 29.75524 14.92247 28.49013 17.92777\n        [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]    [,64]\n[1,] 23.17780 31.21281 39.27708 36.82702 22.21980 29.18595 33.24266 20.40352\n[2,] 23.55482 31.77339 39.99898 37.88345 23.80732 30.89902 33.71999 21.23928\n[3,] 23.66122 31.90784 40.16048 38.11090 24.14338 31.25437 33.83682 21.43753\n        [,65]    [,66]    [,67]    [,68]    [,69]    [,70]    [,71]    [,72]\n[1,] 33.74659 28.44938 37.07130 32.77425 31.78351 27.20854 30.57213 29.61344\n[2,] 34.66157 29.10293 38.14320 33.80115 33.25620 28.93424 32.10660 30.69974\n[3,] 34.86320 29.25753 38.37353 34.02485 33.56533 29.29279 32.42791 30.93668\n        [,73]    [,74]    [,75]    [,76]    [,77]    [,78]    [,79]    [,80]\n[1,] 37.96311 12.98844 12.98844 18.66220 27.75685 31.58018 21.01323 29.00012\n[2,] 38.64257 14.69502 14.69502 19.96937 28.57694 32.07757 22.77865 29.89818\n[3,] 38.79637 15.06295 15.06295 20.25772 28.76424 32.19943 23.14798 30.09950\n        [,81]    [,82]    [,83]    [,84]    [,85]    [,86]    [,87]    [,88]\n[1,] 14.65597 18.99693 33.35526 31.16560 26.21219 27.10166 28.90280 36.36276\n[2,] 16.17108 20.40725 33.96907 31.93374 28.04743 27.97143 30.05298 37.41852\n[3,] 16.50288 20.71401 34.11249 32.10853 28.42665 28.16879 30.30254 37.64605\n        [,89]    [,90]    [,91]    [,92]    [,93]    [,94]    [,95]    [,96]\n[1,] 38.34602 32.17667 33.54567 34.48118 18.03008 23.04029 30.62485 21.68743\n[2,] 39.21427 32.98899 34.51957 35.57410 19.00745 23.83199 32.05881 22.26499\n[3,] 39.40466 33.17168 34.73267 35.80963 19.23599 24.01844 32.36116 22.41220\n        [,97]    [,98]    [,99]   [,100]   [,101]   [,102]   [,103]   [,104]\n[1,] 34.69841 35.48650 32.18757 34.56323 31.10692 31.16667 37.05019 37.03842\n[2,] 35.10866 36.51040 33.64709 35.58076 32.55925 32.91713 38.25723 38.14684\n[3,] 35.21145 36.73218 33.95356 35.80175 32.86483 33.27872 38.51358 38.38423\n       [,105]   [,106]   [,107]   [,108]   [,109]   [,110]   [,111]   [,112]\n[1,] 35.62991 34.12898 38.90208 41.20254 32.17667 28.61636 20.34747 18.60950\n[2,] 36.14020 35.16653 39.77107 41.99134 32.98899 29.40770 21.46260 19.52206\n[3,] 36.26209 35.39158 39.96137 42.16512 33.17168 29.58879 21.71331 19.73753\n       [,113]   [,114]   [,115]   [,116]   [,117]   [,118]   [,119]   [,120]\n[1,] 29.89205 12.04955 37.80103 17.45963 36.17525 35.69670 36.49070 36.49070\n[2,] 31.36932 13.86909 38.55355 18.91100 37.36207 36.82608 37.62031 37.62031\n[3,] 31.68018 14.25776 38.72167 19.22715 37.61488 37.06807 37.86200 37.86200\n       [,121]   [,122]   [,123]   [,124]   [,125]   [,126]   [,127]   [,128]\n[1,] 17.34916 28.01086 22.43183 24.05271 23.17308 37.06122 25.52654 29.48077\n[2,] 18.27324 29.81139 22.94196 24.29549 24.05891 37.64966 25.96138 31.24058\n[3,] 18.49310 30.18346 23.07516 24.37455 24.26313 37.78610 26.07626 31.60451\n       [,129]   [,130]   [,131]   [,132]   [,133]   [,134]   [,135]   [,136]\n[1,] 35.89794 31.98902 15.23040 30.93482 35.23750 32.89720 15.56551 27.08984\n[2,] 36.95795 33.00272 16.83419 32.59990 36.28699 34.04616 17.15271 28.85565\n[3,] 37.18650 33.22433 17.18066 32.94558 36.51382 34.29321 17.49576 29.22168\n       [,137]   [,138]   [,139]   [,140]   [,141]   [,142]   [,143]   [,144]\n[1,] 25.19012 20.05422 34.46591 29.50978 37.84669 37.84669 29.79872 37.75358\n[2,] 25.91580 21.74642 35.57841 30.22865 38.43377 38.43377 30.67406 38.44764\n[3,] 26.08728 22.10326 35.81770 30.39507 38.56956 38.56956 30.87046 38.60439\n       [,145]   [,146]   [,147]   [,148]   [,149]   [,150]   [,151]   [,152]\n[1,] 27.05142 31.11986 34.89548 39.33476 38.51923 32.76404 26.98709 29.20608\n[2,] 27.69858 31.74137 35.40716 40.07805 39.20251 33.19370 27.39986 30.24632\n[3,] 27.85315 31.88774 35.52972 40.24370 39.35680 33.30149 27.50895 30.47473\n       [,153]   [,154]   [,155]   [,156]   [,157]   [,158]   [,159]   [,160]\n[1,] 20.86701 34.46351 37.98781 29.27559 21.67876 35.96049 37.57229 31.53325\n[2,] 22.52542 35.07822 38.45059 30.26274 23.50358 37.11882 38.62512 33.22531\n[3,] 22.87547 35.22117 38.56193 30.48095 23.88322 37.36625 38.85157 33.57583\n       [,161]   [,162]   [,163]   [,164]   [,165]   [,166]   [,167]   [,168]\n[1,] 13.43597 22.31787 21.41356 13.70855 40.78439 27.45701 27.85269 28.21615\n[2,] 15.19614 23.93994 23.03143 15.47890 41.53600 29.20371 29.61167 29.93903\n[3,] 15.57248 24.28224 23.37366 15.85657 41.70269 29.56604 29.97610 30.29661\n       [,169]   [,170]   [,171]   [,172]   [,173]   [,174]   [,175]   [,176]\n[1,] 33.04100 12.31534 32.76533 31.60797 30.40930 21.54997 33.29591 31.27343\n[2,] 33.90144 14.17265 33.74348 33.14272 31.26026 23.31276 34.31163 32.82311\n[3,] 34.09292 14.56720 33.95783 33.46364 31.45154 23.68124 34.53291 33.14698\n       [,177]   [,178]   [,179]   [,180]   [,181]   [,182]   [,183]   [,184]\n[1,] 36.83761 17.10107 39.25696 24.31659 21.94315 30.94398 29.43842 31.06326\n[2,] 37.43434 18.48498 39.93810 24.66071 23.47479 31.88100 31.19075 32.64557\n[3,] 37.57252 18.78947 40.09165 24.75927 23.80081 32.08850 31.55331 32.97566\n       [,185]   [,186]   [,187]   [,188]   [,189]   [,190]   [,191]   [,192]\n[1,] 29.64871 28.37928 37.83639 25.90792 19.62198 21.00867 21.01883 31.65456\n[2,] 30.75271 29.46516 38.39813 26.59619 20.31387 22.46673 22.49208 32.39883\n[3,] 30.99300 29.70283 38.52896 26.75976 20.48608 22.78008 22.80821 32.56868\n       [,193]   [,194]   [,195]   [,196]   [,197]   [,198]   [,199]   [,200]\n[1,] 28.44964 37.16599 38.71412 37.90473 28.88252 13.50283 32.16131 31.35505\n[2,] 29.29283 37.76214 39.22072 38.41496 29.55317 15.21615 33.14865 31.82170\n[3,] 29.48402 37.90004 39.34033 38.53566 29.71074 15.58436 33.36510 31.93770\n       [,201]   [,202]   [,203]   [,204]   [,205]   [,206]   [,207]   [,208]\n[1,] 17.40399 22.94536 19.43044 18.33697 30.95231 28.05355 30.52485 39.26374\n[2,] 18.84920 23.32729 21.18008 19.67518 32.68523 29.02852 31.24122 39.86311\n[3,] 19.16432 23.43495 21.54777 19.96964 33.04360 29.24526 31.40642 40.00066\n       [,209]   [,210]   [,211]   [,212]   [,213]   [,214]   [,215]   [,216]\n[1,] 34.67650 27.19356 35.61145 27.86042 23.86047 27.27085 20.64180 31.84548\n[2,] 35.09424 27.98248 36.66724 29.02429 24.10970 28.96995 22.30833 32.28828\n[3,] 35.19850 28.16425 36.89510 29.27714 24.19026 29.32354 22.66003 32.39927\n       [,217]   [,218]   [,219]   [,220]   [,221]   [,222]   [,223]   [,224]\n[1,] 30.67242 17.99749 16.41756 35.53897 23.49739 40.88811 36.35954 29.38681\n[2,] 32.12938 18.92311 17.48535 36.62999 23.95864 41.68566 36.98671 30.42459\n[3,] 32.43605 19.14208 17.73352 36.86466 24.08100 41.86126 37.13107 30.65240\n       [,225]   [,226]   [,227]   [,228]   [,229]   [,230]   [,231]   [,232]\n[1,] 18.68947 30.80945 40.13834 40.48913 36.02980 28.43464 19.98037 26.28247\n[2,] 20.24923 31.22154 40.86813 41.18300 37.13954 30.20494 20.63253 28.08229\n[3,] 20.58345 31.32726 41.03081 41.33853 37.37760 30.57124 20.79660 28.45495\n       [,233]   [,234]   [,235]   [,236]   [,237]   [,238]   [,239]   [,240]\n[1,] 15.97888 24.12396 31.08449 36.78309 21.20815 28.31804 40.43005 18.79843\n[2,] 17.51861 24.52562 31.64784 37.84424 22.74130 29.18984 41.24655 20.20200\n[3,] 17.85265 24.63563 31.78292 38.07262 23.06822 29.38662 41.42602 20.50778\n       [,241]   [,242]   [,243]   [,244]   [,245]   [,246]   [,247]   [,248]\n[1,] 34.15854 32.96311 15.90278 22.94778 37.53636 14.74263 13.01169 16.46752\n[2,] 35.09907 33.98640 17.53346 23.79027 38.26492 16.10984 14.64176 18.03107\n[3,] 35.30542 34.20931 17.88371 23.98649 38.42849 16.41534 14.99656 18.36865\n       [,249]   [,250]   [,251]   [,252]   [,253]   [,254]   [,255]   [,256]\n[1,] 11.98952 17.88194 20.24564 29.02410 40.39416 33.37806 31.16560 26.61788\n[2,] 13.81096 18.60177 22.02854 29.92858 41.15927 33.98333 31.93374 28.45421\n[3,] 14.20005 18.78239 22.40158 30.13112 41.32874 34.12508 32.10853 28.83345\n       [,257]   [,258]   [,259]   [,260]   [,261]   [,262]   [,263]   [,264]\n[1,] 27.72989 39.56355 32.24084 33.47458 34.20885 18.46159 22.78867 22.95693\n[2,] 28.84919 40.34896 33.06409 34.45319 35.28345 19.25849 23.70264 23.86110\n[3,] 29.09367 40.52272 33.24885 34.66723 35.51558 19.45254 23.91262 24.06903\n       [,265]   [,266]   [,267]   [,268]   [,269]   [,270]   [,271]   [,272]\n[1,] 30.09801 19.00712 40.02139 34.82677 31.48926 31.97107 28.18269 18.50530\n[2,] 31.58283 19.80552 40.71135 35.82378 32.92341 33.50841 28.81679 19.27845\n[3,] 31.89501 19.99891 40.86630 36.04068 33.22539 33.82967 28.96784 19.46795\n       [,273]   [,274]   [,275]   [,276]   [,277]   [,278]   [,279]   [,280]\n[1,] 30.47815 25.57820 40.88811 40.88811 32.24084 33.10827 30.94422 27.13479\n[2,] 31.91016 25.93011 41.68566 41.68566 33.06409 34.23020 31.87527 28.26188\n[3,] 32.21221 26.02875 41.86126 41.86126 33.24885 34.47196 32.08162 28.50827\n       [,281]   [,282]   [,283]   [,284]   [,285]   [,286]   [,287]   [,288]\n[1,] 29.16336 36.75794 23.02032 21.92938 27.49290 27.92249 21.29526 14.21576\n[2,] 30.35501 37.85703 23.49333 22.50786 28.36829 28.82333 23.03569 15.87583\n[3,] 30.61228 38.09274 23.61856 22.65491 28.56641 29.02599 23.40031 16.23370\n       [,289]   [,290]   [,291]   [,292]   [,293]   [,294]   [,295]   [,296]\n[1,] 27.93624 19.18883 27.02220 30.59601 34.96938 31.25049 31.25049 25.23080\n[2,] 29.73261 20.02354 27.48511 32.28064 36.00442 32.25685 32.25685 25.95350\n[3,] 30.10393 20.22346 27.60394 32.63012 36.22859 32.47748 32.47748 26.12436\n       [,297]   [,298]   [,299]   [,300]   [,301]   [,302]   [,303]   [,304]\n[1,] 26.92407 28.92481 37.04184 29.61250 37.92617 31.13550 37.82805 25.35015\n[2,] 28.64225 30.62665 37.75036 30.32248 38.51160 31.94847 38.52330 26.10154\n[3,] 28.99953 30.98002 37.91026 30.48710 38.64703 32.13194 38.68025 26.27779\n       [,305]   [,306]   [,307]   [,308]   [,309]   [,310]   [,311]   [,312]\n[1,] 23.25366 34.75234 19.27779 38.53332 32.35390 32.51710 36.89970 38.17518\n[2,] 24.02938 35.18049 20.80860 39.21270 32.81613 32.98143 37.38176 38.62291\n[3,] 24.21253 35.28676 21.13695 39.36623 32.93058 33.09618 37.49744 38.73120\n       [,313]   [,314]   [,315]   [,316]   [,317]   [,318]   [,319]   [,320]\n[1,] 21.39518 35.90521 21.67765 14.29900 27.90698 27.61600 28.55461 28.55461\n[2,] 23.20847 36.32610 23.32507 16.11695 28.89324 29.31161 30.27227 30.27227\n[3,] 23.58621 36.43029 23.67249 16.50197 29.11225 29.66439 30.62873 30.62873\n       [,321]   [,322]   [,323]   [,324]   [,325]   [,326]   [,327]   [,328]\n[1,] 32.80869 28.86657 30.45193 31.56374 15.14982 15.64048 35.68495 32.98510\n[2,] 33.79511 30.03286 31.99601 33.09094 16.68309 17.21328 36.85270 33.84064\n[3,] 34.01102 30.28549 32.31918 33.41045 17.01726 17.55368 37.10206 34.03121\n       [,329]   [,330]   [,331]   [,332]   [,333]   [,334]   [,335]   [,336]\n[1,] 22.18457 30.48986 29.27658 20.14950 19.62198 26.07837 30.80945 28.06569\n[2,] 23.80323 31.33652 30.43595 20.81508 20.31387 26.81867 31.22154 29.11391\n[3,] 24.14501 31.52692 30.68702 20.98143 20.48608 26.99209 31.32726 29.34463\n       [,337]   [,338]   [,339]   [,340]   [,341]   [,342]   [,343]   [,344]\n[1,] 22.94778 20.93986 17.57960 30.24302 22.95693 18.50530 27.92249 14.21576\n[2,] 23.79027 22.59888 19.03802 31.11308 23.86110 19.27845 28.82333 15.87583\n[3,] 23.98649 22.94898 19.35529 31.30815 24.06903 19.46795 29.02599 16.23370\n       [,345]   [,346]   [,347]   [,348]   [,349]   [,350]   [,351]   [,352]\n[1,] 27.02220 26.92407 29.39025 25.35015 38.59608 36.89970 34.99340 30.31541\n[2,] 27.48511 28.64225 30.12724 26.10154 39.46447 37.38176 35.40942 31.83254\n[3,] 27.60394 28.99953 30.29725 26.27779 39.65478 37.49744 35.51316 32.15071\n       [,353]   [,354]   [,355]   [,356]   [,357]   [,358]   [,359]   [,360]\n[1,] 29.77940 20.24284 27.83633 30.12894 36.83340 30.30280 39.34599 20.10602\n[2,] 30.93936 21.30385 29.65392 30.78057 37.53383 31.41508 39.90869 21.70829\n[3,] 31.19023 21.54462 30.02921 30.93350 37.69225 31.65654 40.03901 22.04879\n       [,361]   [,362]   [,363]   [,364]   [,365]   [,366]   [,367]   [,368]\n[1,] 24.18198 34.02357 28.19057 38.36473 29.23801 30.73994 18.75047 27.45526\n[2,] 24.60628 35.11732 29.29634 39.14594 29.88158 31.46510 20.24862 28.03525\n[3,] 24.72062 35.35323 29.53793 39.31940 30.03362 31.63186 20.57162 28.17644\n       [,369]   [,370]   [,371]   [,372]   [,373]   [,374]   [,375]   [,376]\n[1,] 36.72946 33.60477 32.63360 28.81059 12.92844 39.28562 36.87630 37.05955\n[2,] 37.29689 34.76592 33.76548 29.62815 14.60494 40.00625 37.92786 38.13236\n[3,] 37.42939 35.01496 34.00939 29.81413 14.96783 40.16750 38.15435 38.36287\n       [,377]   [,378]   [,379]   [,380]   [,381]   [,382]   [,383]   [,384]\n[1,] 31.79029 29.54813 37.93550 13.04023 20.97948 28.92381 38.34642 30.62904\n[2,] 33.26541 30.63089 38.61675 14.74961 22.74909 30.07815 39.21496 32.05932\n[3,] 33.57499 30.86719 38.77091 15.11793 23.11921 30.32849 39.40541 32.36097\n       [,385]   [,386]   [,387]   [,388]   [,389]   [,390]   [,391]   [,392]\n[1,] 32.19454 34.58313 31.25126 37.13689 37.09736 18.63065 17.40583 36.52444\n[2,] 33.65317 35.59799 33.00314 38.34326 38.20849 19.54029 18.86461 37.65775\n[3,] 33.95947 35.81845 33.36496 38.59944 38.44638 19.75518 19.18216 37.90014\n       [,393]   [,394]   [,395]   [,396]   [,397]   [,398]   [,399]   [,400]\n[1,] 36.21893 35.71809 36.52444 29.55052 30.99204 32.85928 15.51804 34.44272\n[2,] 37.40727 36.85071 37.65775 31.31373 32.65989 34.00703 17.09699 35.56072\n[3,] 37.66035 37.09330 37.90014 31.67828 33.00607 34.25387 17.43865 35.80109\n       [,401]   [,402]   [,403]   [,404]   [,405]   [,406]   [,407]   [,408]\n[1,] 38.45866 37.99787 35.95815 37.58340 31.53410 22.31776 21.42543 13.74165\n[2,] 39.14416 38.45691 37.12106 38.64236 33.22416 23.93681 23.04610 15.51760\n[3,] 39.29891 38.56751 37.36938 38.86999 33.57431 24.27856 23.38884 15.89618\n       [,409]   [,410]\n[1,] 31.30908 21.97093\n[2,] 32.86203 23.49935\n[3,] 33.18651 23.82476\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndistance_matrix_km_numeric <- matrix(as.numeric(distance_matrix_km), nrow = nrow(distance_matrix_km), ncol = ncol(distance_matrix_km))\n```\n:::\n\n\n# 5 Exploratory Data Analysis (EDA)\n\nLet's start by counting the number of schools in each region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz$`Sch Count`<- lengths(st_intersects(mpsz, schools_sf))\n```\n:::\n\n\nTo list the zone with the most number of schools:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_n(mpsz, 1, `Sch Count`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      142          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2016-05-11 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry Sch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...        13\n```\n:::\n:::\n\n\nWe will also calculate the density of schools in that area:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz$Area <- mpsz %>%\n  st_area()\n\nmpsz <- mpsz %>%\n  mutate(`Sch Density` = `Sch Count`/Area *1000000)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=mpsz, \n       aes(x= as.numeric(`Sch Density`)))+\n  geom_histogram(bins=10, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"Are schools evenly distributed in Singapore?\",\n       subtitle= \"Most sub-zones only have one school.\",\n      x = \"School density (per km sq)\",\n      y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n# 7 Modelling and Visualizing Accessibility using Hansen Method\n\n# 7.1 Computing Hansen's Accessibility\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacc_Hansen <- data.frame(ac(hexagons$demand,\n                            schools_sf$capacity,\n                            D = distance_matrix_km_numeric, \n                            d0 = 50,\n                            power = 2, \n                            family = \"Hansen\"))\n```\n:::\n\n\nWe will rename the default field name.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(acc_Hansen) <- \"accHansen\"\nacc_Hansen <- as_tibble(acc_Hansen)\n```\n:::\n\n\nNow, we will bind the acc_Hansen tibble data frame with the hexagons simple feature data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagon_Hansen <- bind_cols(hexagons, acc_Hansen)\n```\n:::\n\n\n## 7.2 Visualizing Hansen's Accessibility\n\n### 7.2.1 Extracting Map Extend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapex <- st_bbox(hexagons)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntm_shape(hexagon_Hansen,\n         bbox = mapex) + \n  tm_fill(col = \"accHansen\",\n          n = 10,\n          style = \"quantile\",\n          border.col = \"black\",\n          border.lwd = 1) +\ntm_shape(schools_sf) +\n  tm_symbols(size = 0.1) +\n  tm_layout(main.title = \"Accessibility to Schools: Hansen method\",\n            main.title.position = \"center\",\n            main.title.size = 2,\n            legend.outside = FALSE,\n            legend.height = 0.45, \n            legend.width = 3.0,\n            legend.format = list(digits = 6),\n            legend.position = c(\"right\", \"top\"),\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n## 7.3 Statistical Graphic Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhexagon_Hansen <- st_join(hexagon_Hansen, mpsz, join = st_intersects)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=hexagon_Hansen, \n       aes(y = log(accHansen), \n           x= REGION_N)) +\n  geom_boxplot() +\n  geom_point(stat=\"summary\", \n             fun.y=\"mean\", \n             colour =\"red\", \n             size=2)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}